import{_ as l,c,e as t,a,b as s,d as e,r as o,o as i}from"./app-BSRiWrsC.js";const u={},r={href:"https://docs.espressif.com/projects/esp-at/en/release-v2.2.0.0_esp8266/AT_Binary_Lists/ESP8266_AT_binaries.html",target:"_blank",rel:"noopener noreferrer"},k={href:"https://docs.ai-thinker.com/esp8266/sdk",target:"_blank",rel:"noopener noreferrer"},d={href:"https://docs.espressif.com/projects/esp-at/zh_CN/latest/esp32/AT_Command_Set/Basic_AT_Commands.html#",target:"_blank",rel:"noopener noreferrer"};function v(m,n){const p=o("ExternalLinkIcon");return i(),c("div",null,[n[7]||(n[7]=t(`<h2 id="mcu-esp8266" tabindex="-1"><a class="header-anchor" href="#mcu-esp8266"><span>MCU+ESP8266</span></a></h2><p>æƒ³ä½¿ç”¨ESP8266å»ºç«‹TCPæœåŠ¡å°†MCUä¸²å£æ‰“å°æ•°æ®å‘é€åˆ°ç”µè„‘ä¸Šï¼Œè¿™æ ·æ¥æ”¶æ•°æ®æ—¶ç”µè„‘å¯ä»¥ç¦»è®¾å¤‡è¿œä¸€äº›ã€‚</p><p>ä½¿ç”¨æ¨¡å—ä¸ºæœ€æ–°çš„<code>ESP-12S</code></p><p>ä»‹ç»å‡ ä¸ªéœ€è¦ç”¨çš„è½¯ä»¶:</p><ol><li>å»ºç«‹TCPæœåŠ¡çš„ï¼šæˆ‘ç”¨çš„å®‰ä¿¡å¯çš„<code>TCP&amp;UDPæµ‹è¯•å·¥å…·</code>ï¼Œå¯é€‰ç½‘ç»œè°ƒè¯•åŠ©æ‰‹ç­‰ã€‚</li><li>ESP8266è°ƒè¯•å·¥å…·ï¼Œå°†ATæŒ‡ä»¤æŒ‰é”®åŒ–ï¼Œå½“ä¸ç†Ÿæ‚‰ATæŒ‡ä»¤æ—¶ï¼Œå…¥æ‰‹è¿™ä¸ªå¾ˆæ–¹ä¾¿ï¼Œå¯æƒœæ¯æ¬¡é‡æ–°æ‰“å¼€ç¨‹åºä¹‹å‰åšçš„æ›´æ”¹ä¼šè¢«é‡ç½®ï¼Œéœ€è¦é‡å†™WiFiåç§°ã€å¯†ç å’ŒæœåŠ¡IPï¼Œæœ‰ç‚¹éº»çƒ¦ã€‚</li><li>flash_download_toolï¼Œç»™ESP8266çƒ§å½•å›ºä»¶ã€‚</li></ol><h3 id="çƒ§å½•å›ºä»¶" tabindex="-1"><a class="header-anchor" href="#çƒ§å½•å›ºä»¶"><span>çƒ§å½•å›ºä»¶</span></a></h3><p>å‡ºå‚å›ºä»¶ä¸æ”¯æŒæ›´æ”¹ä¸²å£æ³¢ç‰¹ç‡ï¼Œè€Œæˆ‘æƒ³è°ƒé«˜ä¼ æ•°æ®æ›´å¿«ä¸€äº›ï¼Œå°±éœ€è¦å»çƒ§å½•å›ºä»¶ï¼Œæ²¡æƒ³åˆ°ä¸€çƒ§å°±æ˜¯ä¸€ä¸ªä¸‹åˆå•ŠğŸ˜­</p><p>æ‰“å¼€çƒ§å½•å·¥å…·é€‰æ‹©<code>ESP8266</code>å’Œ<code>developer</code>ï¼Œç‚¹ä¸‰ä¸ªç‚¹å¯¼å…¥<code>factory</code>ç‰ˆ<code>bin</code>æ–‡ä»¶åæŒ‰ç…§å›¾è®¾ä¸”è®¾å¤‡æ­£ç¡®è¿æ¥çƒ§å½•å³å¯ã€‚æ³¢ç‰¹ç‡å¯è°ƒæ•´ä¸º921600é¿å…çƒ§å½•å¤ªæ…¢ã€‚</p><p><img src="https://image.krins.cloud/20231206072350.png" alt="20231206072350"></p><p><img src="https://image.krins.cloud/20231206071958.png" alt="20231206071958"></p><p>å½“æˆ‘çƒ§å½•æˆåŠŸåï¼Œé‡è¿ESP8266å‘ç°æ€ä¹ˆå‘é€ATæŒ‡ä»¤éƒ½æ²¡ååº”ï¼Œå½“æˆ‘å°†æ³¢ç‰¹ç‡è°ƒæ•´ä¸º74800ï¼Œè¾“å‡ºä¸å†ä¹±ç è€Œæ˜¯ç±»ä¼¼å¦‚ä¸‹æŠ¥é”™</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">ets Jan <span class="token number">8</span> <span class="token number">2013</span>,rst cause:2, boot mode:<span class="token punctuation">(</span><span class="token number">3,6</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">load 0x40100000, len <span class="token number">6960</span>, room <span class="token number">16</span></span>
<span class="line"><span class="token function">tail</span> <span class="token number">0</span></span>
<span class="line">chksum 0x4f</span>
<span class="line">load 0x3ffe8008, len <span class="token number">24</span>, room <span class="token number">8</span></span>
<span class="line"><span class="token function">tail</span> <span class="token number">0</span></span>
<span class="line">chksum 0xc6</span>
<span class="line">load 0x3ffe8020, len <span class="token number">3196</span>, room <span class="token number">8</span></span>
<span class="line"><span class="token function">tail</span> <span class="token number">4</span></span>
<span class="line">chksum 0x3a</span>
<span class="line">csum 0x3a</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,12)),a("p",null,[n[2]||(n[2]=s("æˆ‘ä»¥ä¸ºæ˜¯çƒ§å½•å‡ºé”™äº†ï¼Œæ¢äº†è®¸å¤šå›ºä»¶å’ŒSPIçƒ§å½•æ¨¡å¼ï¼Œéƒ½ä¸å¾—ç”¨ã€‚æœ€åå‘ç°åŸæ¥æ˜¯")),a("a",r,[n[0]||(n[0]=s("ä¹é‘«å›ºä»¶")),e(p)]),n[3]||(n[3]=s("çƒ§å½•åUARTå¼•è„šä¸ºRx:15ï¼ŒTX:13ï¼Œè€Œæˆ‘æ¿è½½è¿çº¿æ˜¯Rx:15ï¼ŒTx:16ï¼Œæ— å¥ˆåªèƒ½æ›´æ¢å…¶ä»–å›ºä»¶ã€‚åœ¨")),a("a",k,[n[1]||(n[1]=s("å®‰ä¿¡å¯ç›¸å…³ç½‘é¡µ")),e(p)]),n[4]||(n[4]=s("æ‰¾åˆ°ä¸€äº›ä¸ä¼šæ”¹å˜å¼•è„šçš„å›ºä»¶ã€‚åšå®‰é€šçš„ATå›ºä»¶ä»ç„¶ä¸èƒ½æ›´æ”¹æ³¢ç‰¹ç‡ï¼Œå°è¯•ç¬¬äº”ä¸ªï¼šå‡ºå‚é»˜è®¤å›ºä»¶ï¼Œç»ˆäºæˆåŠŸæ›´æ”¹æ³¢ç‰¹ç‡è€Œä¸æ˜¯è¿”å›ERRORäº†ã€‚"))]),n[8]||(n[8]=a("p",null,[s("æ³¨æ„æ›´æ”¹æ³¢ç‰¹ç‡ä¹‹å‰è¦ç”¨å›ºä»¶é»˜è®¤çš„115200é€Ÿç‡è¿æ¥é€šä¿¡ï¼Œç„¶åä½¿ç”¨"),a("code",null,"AT+CIOBAUD=921600"),s("è®¾ç½®æ–°çš„æ³¢ç‰¹ç‡ä¸º921600ï¼Œè¿™ä¸ªè®¾ç½®æ‰ç”µèƒ½ä¼šä¿å­˜ä¸ç”¨é‡æ–°è®¾ç½®ã€‚ç„¶åæ–­å¼€ä¸²å£ï¼Œç”¨921600é€Ÿç‡é‡è¿ä¸²å£å°±èƒ½å’Œè®¾å¤‡æ­£å¸¸é€šä¿¡è€Œä¸ä¼šä¹±ç äº†ã€‚")],-1)),a("p",null,[a("a",d,[n[5]||(n[5]=s("ä¹é‘«ATæŒ‡ä»¤é›†")),e(p)]),n[6]||(n[6]=s("ï¼Œä¸ä¿è¯å›ºä»¶å®Œå…¨æ”¯æŒã€‚"))]),n[9]||(n[9]=t(`<h3 id="ä½¿ç”¨mcuåˆå§‹åŒ–esp8266å»ºç«‹ç½‘ç»œæœåŠ¡" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨mcuåˆå§‹åŒ–esp8266å»ºç«‹ç½‘ç»œæœåŠ¡"><span>ä½¿ç”¨MCUåˆå§‹åŒ–ESP8266å»ºç«‹ç½‘ç»œæœåŠ¡</span></a></h3><p>é¦–å…ˆç¡®ä¿ä¸¤ä¸ªè®¾å¤‡çš„ä¸²å£æ­£ç¡®è¿æ¥ã€‚</p><div class="language-c line-numbers-mode" data-highlighter="prismjs" data-ext="c" data-title="c"><pre><code><span class="line"><span class="token keyword">extern</span> UART_HandleTypeDef huart2<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">char</span> <span class="token operator">*</span>SSID <span class="token operator">=</span> <span class="token string">&quot;LAPTOP-LI4396&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">char</span> <span class="token operator">*</span>PASSWORD <span class="token operator">=</span> <span class="token string">&quot;-Y24j533&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">char</span> <span class="token operator">*</span>serverIP <span class="token operator">=</span> <span class="token string">&quot;192.168.137.1&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">char</span> <span class="token operator">*</span>serverPort <span class="token operator">=</span> <span class="token string">&quot;800&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">ESP8266_Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// AT commands for ESP8266</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;+++&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">HAL_Delay</span><span class="token punctuation">(</span><span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">ESP8266_Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                              <span class="token comment">// test AT startup</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">WaitingForResponse</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">ESP8266_Reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                             <span class="token comment">// soft reset</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">WaitingForResponse</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">ESP8266_SetMode</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                          <span class="token comment">// set mode to station</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">WaitingForResponse</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">ESP8266_ConnectWifi</span><span class="token punctuation">(</span>SSID<span class="token punctuation">,</span> PASSWORD<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// connect to AP</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">WaitingForResponse</span><span class="token punctuation">(</span><span class="token string">&quot;IP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">ESP8266_CIPSTATUS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                         <span class="token comment">// check connection status</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">WaitingForResponse</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">ESP8266_SetMultipleConnections</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// set single connection mode</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">WaitingForResponse</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">ESP8266_ConnectServer</span><span class="token punctuation">(</span>serverIP<span class="token punctuation">,</span> serverPort<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// connect to server</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">WaitingForResponse</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">ESP8266_TransTxEnable</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// enable transparent transmission</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">WaitingForResponse</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">ESP8266_TransTxStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// start transparent transmission</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">WaitingForResponse</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// send data</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-highlighter="prismjs" data-ext="c" data-title="c"><pre><code><span class="line"><span class="token keyword">void</span> <span class="token function">ESP8266_Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;AT\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span> <span class="token comment">// should return OK</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// soft reset</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">ESP8266_Reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;AT+RST\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span> <span class="token comment">// should return OK</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// *view class</span></span>
<span class="line"><span class="token comment">/*</span>
<span class="line">AT+CMD? check current value</span>
<span class="line">AT+CMD=? check command setting range</span>
<span class="line">AT+CMD execute command</span>
<span class="line">*/</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// check mode</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">ESP8266_CheckMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;AT+CWMODE?\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span> <span class="token comment">// should return mode</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 1 is station, 2 is AP, 3 is both</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">ESP8266_SetMode</span><span class="token punctuation">(</span><span class="token keyword">int</span> mode<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;AT+CWMODE=%d\\r\\n&quot;</span><span class="token punctuation">,</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">ESP8266_ConnectWifi</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>ssid<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>password<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;AT+CWJAP=\\&quot;%s\\&quot;,\\&quot;%s\\&quot;\\r\\n&quot;</span><span class="token punctuation">,</span> ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">// check connection status</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">ESP8266_CIPSTATUS</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;AT+CIPSTATUS\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 0 is single, 1 is multiple</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">ESP8266_SetMultipleConnections</span><span class="token punctuation">(</span><span class="token keyword">int</span> enable<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;AT+CIPMUX=%d\\r\\n&quot;</span><span class="token punctuation">,</span> enable <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// conncet to server using TCP</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">ESP8266_ConnectServer</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>ip<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>port<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;AT+CIPSTART=\\&quot;TCP\\&quot;,\\&quot;%s\\&quot;,%s\\r\\n&quot;</span><span class="token punctuation">,</span> ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 0 is non-transparent, 1 is transparent</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">ESP8266_TransTxEnable</span><span class="token punctuation">(</span><span class="token keyword">int</span> enable<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;AT+CIPMODE=%d\\r\\n&quot;</span><span class="token punctuation">,</span> enable <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">ESP8266_TransTxStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;AT+CIPSEND\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// close Transparent Transmission</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">ESP8266_TransTxCancle</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;+++&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// auto connect to server and enable transparent transmission</span></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">ESP8266_AutoConnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;AT+SAVETRANSLINK=1,\\&quot;%s\\&quot;,%d,\\&quot;TCP\\&quot;\\r\\n&quot;</span><span class="token punctuation">,</span> serverIP<span class="token punctuation">,</span> serverPort<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-highlighter="prismjs" data-ext="c" data-title="c"><pre><code><span class="line"><span class="token keyword">int</span> <span class="token function">WaitingForResponse</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>response<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line"><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">char</span> c<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">char</span> buffer<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">int</span> response_length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">HAL_UART_Receive</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>huart2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">uint8_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>c<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">==</span> HAL_OK<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> response<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                buffer<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span></span>
<span class="line">                i<span class="token operator">++</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> response_length<span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">{</span></span>
<span class="line">                    buffer<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">&#39;\\0&#39;</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword">else</span></span>
<span class="line">            <span class="token punctuation">{</span></span>
<span class="line">                i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">                j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword">else</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5))])}const f=l(u,[["render",v]]),g=JSON.parse('{"path":"/blogs/STM32/ESP8266.html","title":"ESP8266çƒ§å½•å›ºä»¶ä¸MCUå¯¹å…¶çš„åˆå§‹åŒ–","lang":"en-US","frontmatter":{"title":"ESP8266çƒ§å½•å›ºä»¶ä¸MCUå¯¹å…¶çš„åˆå§‹åŒ–","date":"2023-12-06T00:00:00.000Z","tags":["STM32","HALåº“"],"categories":["C"]},"headers":[{"level":2,"title":"MCU+ESP8266","slug":"mcu-esp8266","link":"#mcu-esp8266","children":[{"level":3,"title":"çƒ§å½•å›ºä»¶","slug":"çƒ§å½•å›ºä»¶","link":"#çƒ§å½•å›ºä»¶","children":[]},{"level":3,"title":"ä½¿ç”¨MCUåˆå§‹åŒ–ESP8266å»ºç«‹ç½‘ç»œæœåŠ¡","slug":"ä½¿ç”¨mcuåˆå§‹åŒ–esp8266å»ºç«‹ç½‘ç»œæœåŠ¡","link":"#ä½¿ç”¨mcuåˆå§‹åŒ–esp8266å»ºç«‹ç½‘ç»œæœåŠ¡","children":[]}]}],"git":{"createdTime":1744420073000,"updatedTime":1744420073000,"contributors":[{"name":"NewLearner4396","email":"NewLearner4396@users.noreply.github.com","commits":1}]},"filePathRelative":"blogs/STM32/ESP8266.md"}');export{f as comp,g as data};
