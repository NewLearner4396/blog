<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.19">
    <script>
      (function() {
        const userMode = localStorage.getItem('vuepress-reco-color-scheme') || 'auto';
        const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (userMode === 'dark' || (userMode === 'auto' && systemDarkMode)) {
          document.documentElement.classList.toggle('dark', true);
        }
      })();
    </script>
    <style>
      .features__container .magic-card.features__item{
        text-align: center;
        > h4 { font-size: 24px; }
        > p { font-size: 30px; }
      } 
    </style><style>
      .math-block {
        overflow-x: auto; /* 对于长公式，允许水平滚动 */
        margin: 1em 0;
      }
    </style><meta name="referrer" content="no-referrer"><title>基于最小秩估计的红外小目标检测 | Land of Fragment</title><meta name="description" content="My Knowledge Fragments">
    <link rel="preload" href="/assets/style-6pge_xnY.css" as="style"><link rel="stylesheet" href="/assets/style-6pge_xnY.css">
    <link rel="modulepreload" href="/assets/app-BSRiWrsC.js"><link rel="modulepreload" href="/assets/ReWIPI_NRAM.html-EkJFemCP.js">
    <link rel="prefetch" href="/assets/timeline.html-DfeHn2Tg.js" as="script"><link rel="prefetch" href="/assets/posts.html-BfZDQn9T.js" as="script"><link rel="prefetch" href="/assets/friendship-link.html-CUdkYGNJ.js" as="script"><link rel="prefetch" href="/assets/1.html-XvgtUsnW.js" as="script"><link rel="prefetch" href="/assets/1.html-avnTqInM.js" as="script"><link rel="prefetch" href="/assets/1.html-NgcU7KSV.js" as="script"><link rel="prefetch" href="/assets/1.html-CXE0zHtL.js" as="script"><link rel="prefetch" href="/assets/1.html-Cog-kVKi.js" as="script"><link rel="prefetch" href="/assets/1.html-_zvhubRJ.js" as="script"><link rel="prefetch" href="/assets/1.html-ClCg7FGd.js" as="script"><link rel="prefetch" href="/assets/1.html-yt_aD5jy.js" as="script"><link rel="prefetch" href="/assets/1.html-CB0KW2iW.js" as="script"><link rel="prefetch" href="/assets/1.html-BowE8ARr.js" as="script"><link rel="prefetch" href="/assets/1.html-eqCr6DX7.js" as="script"><link rel="prefetch" href="/assets/1.html-BzUo2DSG.js" as="script"><link rel="prefetch" href="/assets/1.html-Bbsmxffu.js" as="script"><link rel="prefetch" href="/assets/1.html-D1KaZrYC.js" as="script"><link rel="prefetch" href="/assets/1.html-BsZV3kvN.js" as="script"><link rel="prefetch" href="/assets/1.html-BGm0_Wx5.js" as="script"><link rel="prefetch" href="/assets/1.html-B1kFZ9mE.js" as="script"><link rel="prefetch" href="/assets/1.html-DGrhAkLt.js" as="script"><link rel="prefetch" href="/assets/1.html-DZ1nTxId.js" as="script"><link rel="prefetch" href="/assets/1.html-CMIkUwD8.js" as="script"><link rel="prefetch" href="/assets/1.html-BNjog0ni.js" as="script"><link rel="prefetch" href="/assets/1.html-Cc40ApdK.js" as="script"><link rel="prefetch" href="/assets/1.html-Bj7-p0It.js" as="script"><link rel="prefetch" href="/assets/1.html-BLQwyT21.js" as="script"><link rel="prefetch" href="/assets/1.html-BOd0TIhR.js" as="script"><link rel="prefetch" href="/assets/1.html-UOioTLnQ.js" as="script"><link rel="prefetch" href="/assets/1.html-DCqxRPiQ.js" as="script"><link rel="prefetch" href="/assets/1.html-Cf7jkBFG.js" as="script"><link rel="prefetch" href="/assets/1.html-Bffo7Z9I.js" as="script"><link rel="prefetch" href="/assets/1.html-DGQzGuaA.js" as="script"><link rel="prefetch" href="/assets/1.html-1aLZjQaN.js" as="script"><link rel="prefetch" href="/assets/1.html-B98SEDc9.js" as="script"><link rel="prefetch" href="/assets/1.html-hj_htl7b.js" as="script"><link rel="prefetch" href="/assets/1.html-C7vICF5f.js" as="script"><link rel="prefetch" href="/assets/1.html-CUjZWUGs.js" as="script"><link rel="prefetch" href="/assets/1.html-CVU23UYr.js" as="script"><link rel="prefetch" href="/assets/1.html-Dn3fPxPr.js" as="script"><link rel="prefetch" href="/assets/1.html-CFEAodqK.js" as="script"><link rel="prefetch" href="/assets/1.html-C4TaKn5K.js" as="script"><link rel="prefetch" href="/assets/1.html-Dw9Zp6ML.js" as="script"><link rel="prefetch" href="/assets/1.html-BBvl4a-w.js" as="script"><link rel="prefetch" href="/assets/1.html-Coi_xg1g.js" as="script"><link rel="prefetch" href="/assets/1.html-CBBFrxJ9.js" as="script"><link rel="prefetch" href="/assets/1.html-BJ0IZfEG.js" as="script"><link rel="prefetch" href="/assets/1.html-TVL-fUtr.js" as="script"><link rel="prefetch" href="/assets/1.html-Disg0Tqq.js" as="script"><link rel="prefetch" href="/assets/2.html-Dgu2oU6o.js" as="script"><link rel="prefetch" href="/assets/3.html-BjFB_Ca1.js" as="script"><link rel="prefetch" href="/assets/4.html-CouYwquB.js" as="script"><link rel="prefetch" href="/assets/5.html-4huYDZh2.js" as="script"><link rel="prefetch" href="/assets/index.html-BaBP6NH6.js" as="script"><link rel="prefetch" href="/assets/Ubuntu.html-CUyx21fh.js" as="script"><link rel="prefetch" href="/assets/VSCode_Jupyter.html-BrhSNgRK.js" as="script"><link rel="prefetch" href="/assets/VSCode_LaTex.html-CTTLq7av.js" as="script"><link rel="prefetch" href="/assets/VSCode_Markdown.html-BfVUtb9r.js" as="script"><link rel="prefetch" href="/assets/VSCode_Matlab.html-wpgIPqA2.js" as="script"><link rel="prefetch" href="/assets/VSCode_Plugins.html-CdFuU2Uj.js" as="script"><link rel="prefetch" href="/assets/VSCode_Verilog.html-C7TEj0F3.js" as="script"><link rel="prefetch" href="/assets/WSL.html-CkqDkr5C.js" as="script"><link rel="prefetch" href="/assets/ssh.html-CdxNmekp.js" as="script"><link rel="prefetch" href="/assets/FFT.html-Cyt0G-8Y.js" as="script"><link rel="prefetch" href="/assets/LinearAlgebra.html-CUYJNMjB.js" as="script"><link rel="prefetch" href="/assets/motorControl.html-rOORs7Mj.js" as="script"><link rel="prefetch" href="/assets/regression.html-DzFtGkXK.js" as="script"><link rel="prefetch" href="/assets/AI_Preliminary.html-DhcBMHnG.js" as="script"><link rel="prefetch" href="/assets/CNN.html-NVeUXorf.js" as="script"><link rel="prefetch" href="/assets/HandWritingRecognize_CNN.html-BIUQzCZf.js" as="script"><link rel="prefetch" href="/assets/MOS.html-CEkMf0Uk.js" as="script"><link rel="prefetch" href="/assets/Tips.html-DlmxC6lL.js" as="script"><link rel="prefetch" href="/assets/ecofinance.html-jWWDV__x.js" as="script"><link rel="prefetch" href="/assets/git.html-jo8r2u5q.js" as="script"><link rel="prefetch" href="/assets/image.html-Bq075vBZ.js" as="script"><link rel="prefetch" href="/assets/matlab.html-CO3aL8yS.js" as="script"><link rel="prefetch" href="/assets/Domain.html-BO42RH5D.js" as="script"><link rel="prefetch" href="/assets/script_UWB.html-nOBmZfSl.js" as="script"><link rel="prefetch" href="/assets/ChristmasTree.html-C7Yz5WQx.js" as="script"><link rel="prefetch" href="/assets/Comment_on_teaching_Script.html-M0-_XaU6.js" as="script"><link rel="prefetch" href="/assets/OriginGuide.html-DU-IiK_m.js" as="script"><link rel="prefetch" href="/assets/datetime.html-Dgd43jgJ.js" as="script"><link rel="prefetch" href="/assets/keyword.html-CsusZbU4.js" as="script"><link rel="prefetch" href="/assets/matplotlib.html-rFtu0-2W.js" as="script"><link rel="prefetch" href="/assets/numpy.html-BXRLo128.js" as="script"><link rel="prefetch" href="/assets/opencv-python.html-DF92fizP.js" as="script"><link rel="prefetch" href="/assets/openpyxl.html-DdbQgKef.js" as="script"><link rel="prefetch" href="/assets/pandas.html-BJRB917g.js" as="script"><link rel="prefetch" href="/assets/statsmodels.html-CO0vW7nK.js" as="script"><link rel="prefetch" href="/assets/time.html-xHI8FETd.js" as="script"><link rel="prefetch" href="/assets/wordcloud.html-BAcUpAHT.js" as="script"><link rel="prefetch" href="/assets/ESP8266.html-qWvnuWBu.js" as="script"><link rel="prefetch" href="/assets/MacroTips_C.html-DsrGeKeX.js" as="script"><link rel="prefetch" href="/assets/Start.html-DpAVNQfM.js" as="script"><link rel="prefetch" href="/assets/usart.html-DGDMRk2c.js" as="script"><link rel="prefetch" href="/assets/Communication_principle.html-NMtyjosA.js" as="script"><link rel="prefetch" href="/assets/Digitial_Signal_Processing.html-CuapP71y.js" as="script"><link rel="prefetch" href="/assets/Random_Signal_Analysis.html-CzWnqTqP.js" as="script"><link rel="prefetch" href="/assets/Signal_and_System.html-NlRnhwLG.js" as="script"><link rel="prefetch" href="/assets/api.html-BV-KS8aa.js" as="script"><link rel="prefetch" href="/assets/home.html-DmI8oyYt.js" as="script"><link rel="prefetch" href="/assets/plugin.html-BZGUY2mm.js" as="script"><link rel="prefetch" href="/assets/theme.html-B7OyyY3g.js" as="script"><link rel="prefetch" href="/assets/404.html-D8Kgek98.js" as="script"><link rel="prefetch" href="/assets/Valine.min-_LyT3bfY.js" as="script"><link rel="prefetch" href="/assets/giscus-aTimukGI-DWEKOTfS.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container series--no show-catalog"><header class="navbar-container not-open"><div class="navbar-inner"><div class="site-brand nav-item"><img class="logo" src="/logo.png" alt="Land of Fragment"><a href="/" class="site-name can-hide">Land of Fragment</a></div><div class="nav-item navbar-links-wrapper" style=""><div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div><nav class="navbar-links"><!--[--><div class="navbar-links__item"><a href="/" class="link" aria-label="Home"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Home<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/timeline.html" class="link" aria-label="TimeLine"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->TimeLine<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/categories/Others/1.html" class="link" aria-label="Categories"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Categories<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/tags/Tips/1.html" class="link" aria-label="Tags"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Tags<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="Docs"><span class="xicon-container left title"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Docs<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="Docs"><span class="title"><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Docs<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a href="/docs/theme-reco/theme" class="link" aria-label="vuepress-reco"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->vuepress-reco<!--]--></span></span><!--[--><!--]--></a></li><li class="dropdown-link__item"><a href="/blogs/Others/OriginGuide" class="link" aria-label="vuepress-theme-reco"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->vuepress-theme-reco<!--]--></span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links__item"><a href="/friendship-link.html" class="link" aria-label="Link"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Link<!--]--></span></span><!--[--><!--]--></a></div><!--]--><!----><span class="xicon-container btn-toggle-dark-mode btn--dark-mode navbar-links__item"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></span><ul class="social-links navbar-links__item"><!--[--><!--]--></ul></nav><span class="xicon-container btn-toggle-menus"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><circle cx="16" cy="8" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="24" r="2" fill="currentColor"></circle></svg></span></div></div></header><!----><!----><!----><div class="theme-main" style=""><!----><!--[--><main class="page-container"><div class="page-content"><h1 class="page-title">基于最小秩估计的红外小目标检测</h1><div class="page-info"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M16 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M26 30h-2v-5a5 5 0 0 0-5-5h-6a5 5 0 0 0-5 5v5H6v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->NewLearner4396<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2022-10-20<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/categories/Search/1.html" class="">Search</a><!--]--><!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M10 14a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4zm0-6a2 2 0 1 0 1.998 2.004A2.002 2.002 0 0 0 10 8z" fill="currentColor"></path><path d="M16.644 29.415L2.586 15.354A2 2 0 0 1 2 13.941V4a2 2 0 0 1 2-2h9.941a2 2 0 0 1 1.414.586l14.06 14.058a2 2 0 0 1 0 2.828l-9.943 9.943a2 2 0 0 1-2.829 0zM4 4v9.942L18.058 28L28 18.058L13.942 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/tags/RemoteSensing/1.html" class="">RemoteSensing</a><!--]--><!--]--></span></span><!----></div><div class="theme-reco-md-content"><div><h2 id="基于最小化联合l2-1范数的非凸秩估计的红外小目标检测" tabindex="-1"><a class="header-anchor" href="#基于最小化联合l2-1范数的非凸秩估计的红外小目标检测"><span>基于最小化联合l2,1范数的非凸秩估计的红外小目标检测</span></a></h2><h3 id="ipi模型" tabindex="-1"><a class="header-anchor" href="#ipi模型"><span>IPI模型</span></a></h3><p><strong>IPI模型：</strong></p><p><img src="http://imagebed.krins.cloud/api/image/0064JB6X.png" alt="image-20221021155105726"></p><p>原图像D由背景B、目标T、噪声N组成。</p><p>IPI模型基于两个假设，<strong>背景图像是一个低秩矩阵，目标图像是一个稀疏矩阵</strong>。论文提到该假设较为符合物理实际，并且现在有很多高效的低秩矩阵恢复的方法，所以这个模型效率和泛用性极高。</p><p>该模型通过滑动窗将原图像进行提取，将得到的每个面片（Patch）拉伸成一维列向量，n个列向量组合成新的矩阵，即公式中的D。</p><p>T是一个稀疏矩阵，即<img src="http://imagebed.krins.cloud/api/image/806T6280.png" alt="image-20221021155358366"></p><p>T的非零元个数小于k，k远小于T矩阵的元素个数</p><p>B是一个低秩矩阵，即</p><p><img src="http://imagebed.krins.cloud/api/image/40Z08HFF.png" alt="image-20221021155706114"></p><p>r是一个常数，对于越高复杂度的背景，r越高。实验中，背景图像的奇异值总是迅速收敛到0，印证了该假设的正确性。</p><p>由于一张图像较远像素也往往有较高相关性，提取出的D通常可以使用现有的许多非局部自相似性的方法。</p><p>N假设为一个i.i.d(独立同分布白噪声)</p><p><img src="http://imagebed.krins.cloud/api/image/06T4R6L2.png" alt="image-20221021160520947"></p><p>在该模型中的k,r,<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FF TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>δ</mi></math></mjx-assistive-mml></mjx-container>,对不同图像不同，但好消息是我们不需要直接计算出这些值。</p><p><strong>通过该模型小目标检测实际上是从数据矩阵中恢复低秩分量和稀疏分量的问题</strong></p><p>即：</p><p><img src="http://imagebed.krins.cloud/api/image/D4FPTXPP.png" alt="image-20221021161136496"></p><p>可转换为对应问题</p><p><img src="http://imagebed.krins.cloud/api/image/64BJL0H0.png" alt="image-20221021161216174"></p><p>因为该问题是一个凸问题，可以使用 Accelerated Proximal Gradient (APG)求解</p><p><img src="http://imagebed.krins.cloud/api/image/8H8FH222.png" alt="image-20221021161435605"></p><p>其中</p><p><img src="http://imagebed.krins.cloud/api/image/6B0LV62P.png" alt="image-20221021161459558"></p><p>该模型完整求解过程</p><p><img src="http://imagebed.krins.cloud/api/image/2NPDVH82.png" alt="image-20221021161712075"></p><p>首先，根据从图像序列获得的原始红外图像fD构建补丁图像D。 其次，将算法1应用于斑块图像D以同时估计低秩背景斑块图像B和稀疏目标斑块图像T。 第三，我们分别从补丁图像B和T重建背景图像fB和目标图像fT。 第四，我们使用一种简单的分割方法来自适应地分割目标图像fT，因为它包含一些小值的误差。最后，通过后处理，对分割结果进行细化，得到最终的检测结果。</p><p>在算法1中，选择<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-TeXAtom texclass="ORD"><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-sop"><mjx-c class="mjx-c221A TEX-S1"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top:0.107em;"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-box></mjx-sqrt></mjx-msqrt></mjx-TeXAtom></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi><mo>=</mo><mn>1</mn><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mrow data-mjx-texclass="ORD"><msqrt><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>m</mi><mo>,</mo><mi>n</mi><mo stretchy="false">)</mo></msqrt></mrow></math></mjx-assistive-mml></mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D702 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c39"></mjx-c><mjx-c class="mjx-c39"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi><mo>=</mo><mn>0.99</mn></math></mjx-assistive-mml></mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D707 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-msub space="4"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>μ</mi><mn>0</mn></msub><mo>=</mo><msub><mi>s</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-TeXAtom texclass="ORD"><mjx-mover><mjx-over style="padding-bottom:0.105em;padding-left:0.329em;margin-bottom:-0.544em;"><mjx-mo class="mjx-n" style="width:0;margin-left:-0.25em;"><mjx-c class="mjx-cAF"></mjx-c></mjx-mo></mjx-over><mjx-base><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D707 TEX-I"></mjx-c></mjx-mi></mjx-base></mjx-mover></mjx-TeXAtom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c2E"></mjx-c><mjx-c class="mjx-c30"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c34"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mover><mi>μ</mi><mo stretchy="false">¯</mo></mover></mrow><mo>=</mo><mn>0.05</mn><msub><mi>s</mi><mn>4</mn></msub></math></mjx-assistive-mml></mjx-container>, <mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D460 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c34"></mjx-c></mjx-mn></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>2</mn></msub><mo>,</mo><msub><mi>s</mi><mn>4</mn></msub></math></mjx-assistive-mml></mjx-container>是D的第二和第四奇异值。</p><p>第三步中重叠部分的像素使用中值滤波器，比均值滤波器鲁棒性更好。</p><p>第四步中设置阈值确定目标：</p><p><img src="http://imagebed.krins.cloud/api/image/86DV6F60.png" alt="image-20221021162522338"></p><p>可按需要选择双边阈值：</p><p><img src="http://imagebed.krins.cloud/api/image/X82Z046T.png" alt=""></p><p><img src="http://imagebed.krins.cloud/api/image/48TL2TT0.png" alt="image-20221021162600732"></p><p><mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-utext style="font-family:MJXZERO, serif;" variant="normal">、</mjx-utext></mjx-mo></mjx-TeXAtom><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-utext style="font-family:MJXZERO, serif;" variant="normal">、</mjx-utext></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mrow data-mjx-texclass="ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mrow data-mjx-texclass="ORD"><mo>、</mo></mrow><msub><mi>v</mi><mrow data-mjx-texclass="ORD"><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mrow data-mjx-texclass="ORD"><mo>、</mo></mrow><mi>k</mi></math></mjx-assistive-mml></mjx-container>为经验确定的常数，<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D707 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-utext style="font-family:MJXZERO, serif;" variant="normal">、</mjx-utext></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi><mrow data-mjx-texclass="ORD"><mo>、</mo></mrow><mi>σ</mi></math></mjx-assistive-mml></mjx-container>为<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;margin-left:-0.06em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>T</mi></msub></math></mjx-assistive-mml></mjx-container>的均值和标准差</p><p>最后一步的后处理中可使用区域分析方法去删除错误检测目标，可使用形态学方法去提炼目标区域。并且使用统计技术估计目标在重建背景图像中的对应局部区域的复杂度，然后利用估计结果评估器可靠性。</p><p>参考链接：<a href="https://ieeexplore.ieee.org/document/6595533" target="_blank" rel="noopener noreferrer">Infrared Patch-Image Model for Small Target Detection in a Single Image<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>然而由于核范数和1范数平等对待所有奇异值，算出来的秩与真秩有些许偏差，所以迭代结果可能只是局部最优解，也就是说，不能精确分离复杂图像的背景和目标。</p><p>后人通过 non-convex rank approximation 来改进 principal component analysis（PCA），同时新提出的 alternating direction method of multipliers（ADMM）比 accelerated proximal gradient（APG）收敛更快更精确，可以进一步优化算法。</p><h3 id="rewipi模型" tabindex="-1"><a class="header-anchor" href="#rewipi模型"><span>ReWIPI模型</span></a></h3><p>传统IPI模型由于l1范数不能完全描述稀疏性的缺陷，会过于缩小小目标或在目标图像中留下背景成分。并且由于强边缘也有可能是稀疏的，无法简单地与小目标进行区分。</p><p>通过结合结构先验信息，为每个patch自适应权重，提出了名为加权IPI weighted IPI（WIPI）的方法，然而每个patch都要进行计算，十分费时。并且仅能分离某些特定类型的强边缘。</p><p>WIPI的作者分析，其性能不令人满意的原因是<strong>缺少相似的边缘样本</strong>。虽然在奇异值部分和最小化partial sum minimisation of singular values（PSSV）方法的帮助下，可以保留较大的奇异值。然而，该方法仍需准确估计目标的秩，这实际上很难实现。</p><p>而且现有的基于低秩的方法没有考虑到亮度较低的非目标稀疏点的存在，很容易误认成为目标。</p><p>进一步分析，基于强边缘是否属于核范数最小化假设的相似边缘样本，可以将强边缘划分为强势的强边缘与弱势的强边缘。这两种强边缘都是全局稀疏的，但是只有弱势的强边缘是面片patch之间仍具有稀疏性。通过最后分离的结果来看，只有弱势的强边缘留在了目标图像中，也就是说，<strong>面片之间的稀疏性比面片内部的稀疏性更容易使得目标留在目标图像</strong>。所以<strong>IPI模型性能不足的真实原因是存在具有面片间稀疏性的弱势强边缘同小目标进行混淆</strong>。</p><p>所以我们急需一种方法可以抑制目标图像中的非目标稀疏点的同时保持背景强边缘。</p><p>基于<strong>加权核范数最小化weighted nuclear norm minimisation (WNNM)可以通过较小的权重惩罚较大的奇异值</strong>的特点，可以用来得到更为准确的背景图像。并且此方法并不需要准确计算出背景图像的秩。还可以<strong>使用加权l1范数weighted l1 norm，通过较大的权重惩罚非目标图像</strong>，得到更为准确的目标图像。根据这两种想法，可以提出一种新的IPI模型，reweighted IPI。</p><p>加权核范数定义为：</p><p><img src="http://imagebed.krins.cloud/api/image/8LN42FFX.png" alt="image-20221023224745792"></p><p>加权1范数定义为：</p><p><img src="http://imagebed.krins.cloud/api/image/0JJXD446.png" alt="image-20221023224902789"></p><p>对于噪声图像，我们假设其符合高斯分布，所以有：</p><p><img src="http://imagebed.krins.cloud/api/image/JBN2DJRX.png" alt="image-20221023225118819"></p><p>于是ReWIPI可表示成：</p><p><img src="http://imagebed.krins.cloud/api/image/6J820686.png" alt="image-20221023225151555"></p><p>该问题可以用拉格朗日乘子法等多种方法求解，见下文</p><p>参考：<a href="https://ietresearch.onlinelibrary.wiley.com/doi/full/10.1049/iet-ipr.2017.0353" target="_blank" rel="noopener noreferrer">Small target detection based on reweighted infrared patch-image model<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="robust-pca-via-nonconvex-rank-approximation" tabindex="-1"><a class="header-anchor" href="#robust-pca-via-nonconvex-rank-approximation"><span>Robust PCA via Nonconvex Rank Approximation</span></a></h3><p>主成分分析principal component analysis(PCA)是一种很好的将原始高维数据投影到低维空间的降维技术。然而，一旦存在一个严重偏离实际的数据，PCA的结果将会不尽人意。</p><p>为了增强对异常值或观测时损坏的数据的鲁棒性，我们需要一种算法进行Robust PCA（RPCA），并尽可能保证算法复杂度较低。</p><p>通常来说，问题可以建模成：</p><p><img src="http://imagebed.krins.cloud/api/image/DHXD20H4.png" alt="image-20221021191620601"></p><p>找到实际低秩矩阵的秩和实际稀疏矩阵的非零元个数，也就是最小化所认定为低秩矩阵的秩以及所认定的稀疏矩阵的非零元个数。</p><p>以上问题是一个NP-Hard问题。但可以通过将非凸的秩函数放松成核函数，将l0范数放松成l1范数进行简化成凸函数:</p><p><img src="http://imagebed.krins.cloud/api/image/NDXR46LB.png" alt="image-20221023141809913"></p><p>在不相干假设下，低秩矩阵和稀疏分量可以以压倒性的概率准确恢复。参考：<a href="https://ieeexplore.ieee.org/document/889420" target="_blank" rel="noopener noreferrer">Robust principal component analysis?<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>遇到的问题：</p><ol><li>不是所有矩阵都能有一致性保证（满足不相干假设），数据可能会严重损坏，这样求出的最优解会明显偏离真值。</li><li>核函数本质上是矩阵奇异值的l1范数，然而l1范数本身就有收缩效应，这会导致得到的估计是有偏的。也就是说，RPCA将所有奇异值平均加权实际上过度惩罚了大的奇异值，导致结果偏离了较多。</li></ol><p>虽然我们可以利用对l1范数的非凸惩罚，如截断的l1范数进行修正。但是这些方法只适用于特殊场景。</p><p>于是提出利用一种新的非凸函数进行对秩的逼近，通过增强的拉格朗日乘子法 Augmented Lagrange Multiplier (ALM) 求解此非凸函数。</p><p>定义的新<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></mjx-assistive-mml></mjx-container>范数:</p><p><img src="http://imagebed.krins.cloud/api/image/V2BJ0R6X.png" alt="image-20221023143918447"></p><p>问题变成:</p><p><img src="http://imagebed.krins.cloud/api/image/08J6Z680.png" alt="image-20221023154909795"></p><p>ALM：</p><p><img src="http://imagebed.krins.cloud/api/image/N0TB40JN.png" alt="image-20221023153952105"></p><p>Y是拉格朗日乘子，用于消除等式约束，<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D707 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi></math></mjx-assistive-mml></mjx-container>是一个正参数，用来稍加约束误差，引入Frobenius 范数计算误差作为二次惩罚项。&lt;·, ·&gt;是两个矩阵的内积，也可以表示成<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D435 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msup><mi>A</mi><mi>T</mi></msup><mi>B</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>.</p><p>通过以下方程更新L，Y，<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D707 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi></math></mjx-assistive-mml></mjx-container>直至收敛：</p><p><img src="http://imagebed.krins.cloud/api/image/2ZFBB4X6.png" alt="image-20221023154604521"></p><p><img src="http://imagebed.krins.cloud/api/image/468L062N.png" alt="image-20221023155545407"></p><p><img src="http://imagebed.krins.cloud/api/image/060H42Z2.png" alt="image-20221023155507969"></p><p>L的迭代求解：</p><p>因为对于优化问题：<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top:0.167em;padding-left:0.578em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D44D TEX-I"></mjx-c></mjx-mi></mjx-under></mjx-row></mjx-munder><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mfrac space="3"><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D707 TEX-I"></mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-script style="vertical-align:-0.298em;margin-left:0;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-spacer style="margin-top:0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo data-mjx-texclass="OP">min</mo><mi>Z</mi></munder><mi>F</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo><mo>+</mo><mfrac><mi>μ</mi><mn>2</mn></mfrac><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>Z</mi><mo>−</mo><mi>A</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><msubsup><mo stretchy="false">|</mo><mi>F</mi><mn>2</mn></msubsup></math></mjx-assistive-mml></mjx-container>的最优解<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44D TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;margin-left:0.052em;"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2217"></mjx-c></mjx-mo></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Z</mi><mo>∗</mo></msup></math></mjx-assistive-mml></mjx-container>可SVD成<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-munderover space="2" limits="false"><mjx-mo class="mjx-sop"><mjx-c class="mjx-c2211 TEX-S1"></mjx-c></mjx-mo><mjx-script style="vertical-align:-0.285em;margin-left:0;"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2217"></mjx-c></mjx-mo><mjx-spacer style="margin-top:0.304em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D44D TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-munderover><mjx-msup space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;margin-left:0.059em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi><munderover><mo data-mjx-texclass="OP">∑</mo><mi>Z</mi><mo>∗</mo></munderover><msup><mi>V</mi><mi>T</mi></msup></math></mjx-assistive-mml></mjx-container>,<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-munderover limits="false"><mjx-mo class="mjx-sop"><mjx-c class="mjx-c2211 TEX-S1"></mjx-c></mjx-mo><mjx-script style="vertical-align:-0.285em;margin-left:0;"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2217"></mjx-c></mjx-mo><mjx-spacer style="margin-top:0.304em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D44D TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-munderover><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2217"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><munderover><mo data-mjx-texclass="OP">∑</mo><mi>Z</mi><mo>∗</mo></munderover><mo>=</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo stretchy="false">(</mo><msup><mi>σ</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>,<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2217"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mo>∗</mo></math></mjx-assistive-mml></mjx-container>是优化问题<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45F TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi><mjx-munder space="2"><mjx-row><mjx-base><mjx-mo class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c69"></mjx-c><mjx-c class="mjx-c6E"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top:0.167em;padding-left:0.18em;"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2265"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mfrac space="3"><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D707 TEX-I"></mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n"><mjx-c class="mjx-c2016"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.153em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-msubsup><mjx-mo class="mjx-n"><mjx-c class="mjx-c2016"></mjx-c></mjx-mo><mjx-script style="vertical-align:-0.298em;margin-left:0;"><mjx-mn class="mjx-n" size="s"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-spacer style="margin-top:0.18em;"></mjx-spacer><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D439 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>r</mi><mi>g</mi><munder><mo data-mjx-texclass="OP">min</mo><mrow data-mjx-texclass="ORD"><mi>σ</mi><mo>≥</mo><mn>0</mn></mrow></munder><mi>f</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo><mo>+</mo><mfrac><mi>μ</mi><mn>2</mn></mfrac><mo data-mjx-texclass="ORD" fence="false" stretchy="false">‖</mo><mi>σ</mi><mo>−</mo><msub><mi>σ</mi><mi>A</mi></msub><msubsup><mo data-mjx-texclass="ORD" fence="false" stretchy="false">‖</mo><mi>F</mi><mn>2</mn></msubsup></math></mjx-assistive-mml></mjx-container>的最优解。</p><p>而上述问题又是凹函数和凸函数的联合，可以用差分凸规划 difference of convex (DC) programing迭代优化,直至收敛：</p><p><img src="http://imagebed.krins.cloud/api/image/T60HN6F8.png" alt="image-20221023164609814"></p><p>其中<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>k</mi></msub></math></mjx-assistive-mml></mjx-container>是<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msub><mi>σ</mi><mi>k</mi></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>的梯度</p><p>最后<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D451 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D454 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-mo class="mjx-n" size="s"><mjx-c class="mjx-c2217"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D449 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;margin-left:0.059em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>L</mi><mrow data-mjx-texclass="ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>U</mi><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo stretchy="false">(</mo><msup><mi>σ</mi><mo>∗</mo></msup><mo stretchy="false">)</mo><msup><mi>V</mi><mi>T</mi></msup></math></mjx-assistive-mml></mjx-container></p><p>S的迭代求解：</p><p>若方程13用的是S的联合2,1范数，则解可以表示成：</p><p><img src="http://imagebed.krins.cloud/api/image/88X4XNVB.png" alt="image-20221023155840951"></p><p>其中：<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D444 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4"><mjx-c class="mjx-c1D44B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msup space="3"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msup><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mfrac space="3"><mjx-frac><mjx-num><mjx-nstrut></mjx-nstrut><mjx-msup size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44C TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;margin-left:0.059em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-num><mjx-dbox><mjx-dtable><mjx-line></mjx-line><mjx-row><mjx-den><mjx-dstrut></mjx-dstrut><mjx-msup size="s"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D707 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.289em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msup></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo>=</mo><mi>X</mi><mo>−</mo><msup><mi>L</mi><mrow data-mjx-texclass="ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>−</mo><mfrac><msup><mi>Y</mi><mi>t</mi></msup><msup><mi>μ</mi><mi>t</mi></msup></mfrac></math></mjx-assistive-mml></mjx-container>,<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;margin-left:0.052em;"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msup><mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c3A"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msup><mi>S</mi><mrow data-mjx-texclass="ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><msub><mo stretchy="false">]</mo><mrow data-mjx-texclass="ORD"><mo>:</mo><mo>,</mo><mi>i</mi></mrow></msub></math></mjx-assistive-mml></mjx-container> 是<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;margin-left:0.052em;"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msup></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>S</mi><mrow data-mjx-texclass="ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup></math></mjx-assistive-mml></mjx-container>的第i列,<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msub><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s" texclass="ORD"><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-munder space="4"><mjx-row><mjx-base><mjx-mo class="mjx-sop"><mjx-c class="mjx-c2211 TEX-S1"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top:0.167em;padding-left:0.406em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-under></mjx-row></mjx-munder><mjx-msqrt space="2"><mjx-sqrt><mjx-surd><mjx-mo class="mjx-s3"><mjx-c class="mjx-c221A TEX-S3"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top:0.231em;"><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-sop"><mjx-c class="mjx-c2211 TEX-S1"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top:0.167em;padding-left:0.382em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-under></mjx-row></mjx-munder><mjx-TeXAtom space="2" texclass="ORD"><mjx-msubsup><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.294em;margin-left:-0.032em;"><mjx-mn class="mjx-n" size="s" style="margin-left:0.118em;"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-spacer style="margin-top:0.18em;"></mjx-spacer><mjx-TeXAtom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msubsup></mjx-TeXAtom></mjx-box></mjx-sqrt></mjx-msqrt></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">|</mo><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>S</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><msub><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mrow data-mjx-texclass="ORD"><mn>2</mn><mo>,</mo><mn>1</mn></mrow></msub><mo>=</mo><munder><mo data-mjx-texclass="OP" movablelimits="false">∑</mo><mi>i</mi></munder><msqrt><munder><mo data-mjx-texclass="OP" movablelimits="false">∑</mo><mi>j</mi></munder><mrow data-mjx-texclass="ORD"><msubsup><mi>S</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup></mrow></msqrt></math></mjx-assistive-mml></mjx-container></p><p>若用的S的1范数，则解可以表示成：</p><p><img src="http://imagebed.krins.cloud/api/image/R026BD62.png" alt="image-20221023160452582"></p><p>参数设置</p><ol><li><p><mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi></math></mjx-assistive-mml></mjx-container></p><p><mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi></math></mjx-assistive-mml></mjx-container>太大会导致S迭代成0，最后L仍为一个高秩矩阵，<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi></math></mjx-assistive-mml></mjx-container>太小会导致L最后为0，可以将<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi></math></mjx-assistive-mml></mjx-container>设置成<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mn class="mjx-n"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-TeXAtom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo></mjx-TeXAtom><mjx-msqrt><mjx-sqrt><mjx-surd><mjx-mo class="mjx-sop"><mjx-c class="mjx-c221A TEX-S1"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top:0.107em;"><mjx-mo class="mjx-n"><mjx-c class="mjx-c6D"></mjx-c><mjx-c class="mjx-c61"></mjx-c><mjx-c class="mjx-c78"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-box></mjx-sqrt></mjx-msqrt></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><msqrt><mo data-mjx-texclass="OP" movablelimits="true">max</mo><mo stretchy="false">(</mo><mi>m</mi><mo>,</mo><mi>n</mi><mo stretchy="false">)</mo></msqrt></math></mjx-assistive-mml></mjx-container>邻域的任意值，实验证明<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D706 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi></math></mjx-assistive-mml></mjx-container>在相当范围内不敏感，可以设置成10e-3</p></li><li><p><mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70C TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi></math></mjx-assistive-mml></mjx-container></p><p><mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70C TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3E"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi><mo>&gt;</mo><mn>1</mn></math></mjx-assistive-mml></mjx-container>，若<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70C TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi></math></mjx-assistive-mml></mjx-container>较大，则收敛更快，若<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D70C TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ρ</mi></math></mjx-assistive-mml></mjx-container>较小，则结果更精确。通常取1.1。</p></li><li><p><mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D707 TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi></math></mjx-assistive-mml></mjx-container></p><p>可分别取1e-4，3e-3，0.5,4进行实验确定效果</p></li></ol><p>参考论文：<a href="https://ieeexplore.ieee.org/document/7373325" target="_blank" rel="noopener noreferrer">Robust PCA via Nonconvex Rank Approximation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><hr><p><strong>根据以上工作，提出以下方法</strong></p><h3 id="infrared-small-target-detection-via-non-convex-rank-approximation-minimization-joint-l2-1-norm" tabindex="-1"><a class="header-anchor" href="#infrared-small-target-detection-via-non-convex-rank-approximation-minimization-joint-l2-1-norm"><span>Infrared Small Target Detection via Non-Convex Rank Approximation Minimization Joint l2,1 Norm</span></a></h3><h4 id="算法原理" tabindex="-1"><a class="header-anchor" href="#算法原理"><span>算法原理</span></a></h4><p><img src="http://imagebed.krins.cloud/api/image/X08D4268.png" alt="image-20221017140935731"></p><p>引用一种 <mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></mjx-assistive-mml></mjx-container> norm</p><p><img src="http://imagebed.krins.cloud/api/image/40PPTD8R.png" alt="image-20221017140923454"></p><p><mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></mjx-assistive-mml></mjx-container>趋近0是B的秩，趋于无穷是B的核范数。</p><p>显然，<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></mjx-assistive-mml></mjx-container>范数几乎与真秩一致（此处使用<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></mjx-assistive-mml></mjx-container>=0.002），解决了传统凸核范数中不同奇异值的不平衡惩罚</p><p>weighted nuclear norm（WNN）的逼近效果也很好，但每次都要重新计算权重时都要重新进行奇异值分解，增加了计算量。总体性能并不能比上<mjx-container class="MathJax" jax="CHTML" style="font-size:110%;position:relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D6FE TEX-I"></mjx-c></mjx-mi></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></mjx-assistive-mml></mjx-container>范数。</p><p><img src="http://imagebed.krins.cloud/api/image/PB26X848.png" alt="image-20221021174453131"></p><p>加权1范数</p><p><img src="http://imagebed.krins.cloud/api/image/N88B22XN.png" alt="image-20221017140951106"></p><p>复杂背景下的强边缘会在目标图像中留下残余。为了解决这个问题，并考虑到目标图像中留下的强边缘相对于整个图像来说是线性结构的稀疏性，我们引入了联合2,1范数来有效地去除强边缘</p><p>联合2,1范数</p><p><img src="http://imagebed.krins.cloud/api/image/HRXDPZBJ.png" alt="image-20221017141000213"></p><p>于是目标问题就变成</p><p><img src="http://imagebed.krins.cloud/api/image/6HRHLPL0.png" alt="image-20221017141013452"></p><p>引入拉格朗日乘子项和二次惩罚项将问题简化</p><p><img src="http://imagebed.krins.cloud/api/image/2TZD6JJ6.png" alt="image-20221017141130929"></p><p>问题进一步转换成一下子问题：</p><p><img src="http://imagebed.krins.cloud/api/image/NBL84BZ4.png" alt="image-20221017141240575"></p><p>可以通过最小化加权核范数逐渐求得B</p><p><img src="http://imagebed.krins.cloud/api/image/J80604LV.png" alt="image-20221017142344020"></p><p>对于联合2,1范数，T的迭代解可以表示成：</p><p><img src="http://imagebed.krins.cloud/api/image/D2P4R0XB.png" alt="image-20221017142409602"></p><p><img src="http://imagebed.krins.cloud/api/image/62LRL06Z.png" alt="image-20221017142434618"></p><p><img src="http://imagebed.krins.cloud/api/image/JH62J6NJ.png" alt="image-20221017142445556"></p><p><img src="http://imagebed.krins.cloud/api/image/BRB820H0.png" alt="image-20221017142456163"></p><p>算法流程如下：</p><p><img src="http://imagebed.krins.cloud/api/image/PT6NRBNL.png" alt="image-20221017173929903"></p><p><img src="http://imagebed.krins.cloud/api/image/2PHH66D2.png" alt="image-20221017173939217"></p><h4 id="对应matlab代码" tabindex="-1"><a class="header-anchor" href="#对应matlab代码"><span>对应matlab代码</span></a></h4><div class="language-matlab line-numbers-mode" data-highlighter="prismjs" data-ext="matlab" data-title="matlab"><pre><code><span class="line"><span class="token comment">% 主程序</span></span>
<span class="line">clc<span class="token punctuation">;</span>clear<span class="token punctuation">;</span></span>
<span class="line">close all<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token function">addpath</span><span class="token punctuation">(</span><span class="token string">&#39;functions/&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token function">addpath</span><span class="token punctuation">(</span><span class="token string">&#39;tools/&#39;</span><span class="token punctuation">)</span></span>
<span class="line">saveDir <span class="token operator">=</span> <span class="token string">&#39;results/&#39;</span><span class="token punctuation">;</span></span>
<span class="line">imgpath <span class="token operator">=</span> <span class="token string">&#39;images/&#39;</span><span class="token punctuation">;</span></span>
<span class="line">imgDir <span class="token operator">=</span> <span class="token function">dir</span><span class="token punctuation">(</span><span class="token punctuation">[</span>imgpath <span class="token string">&#39;*.bmp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">% patch parameters</span></span>
<span class="line">patchSize <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span></span>
<span class="line">slideStep <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span></span>
<span class="line">lambdaL <span class="token operator">=</span> <span class="token number">0.7</span><span class="token punctuation">;</span>  <span class="token comment">%tuning</span></span>
<span class="line"></span>
<span class="line">len <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>imgDir<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">% for i=1:len</span></span>
<span class="line"><span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>len</span>
<span class="line">    img <span class="token operator">=</span> <span class="token function">imread</span><span class="token punctuation">(</span><span class="token punctuation">[</span>imgpath <span class="token function">imgDir</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    figure<span class="token punctuation">,</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">131</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">imshow</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">&#39;Original image&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">if</span> <span class="token function">ndims</span><span class="token punctuation">(</span> img <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span></span>
<span class="line">        img <span class="token operator">=</span> <span class="token function">rgb2gray</span><span class="token punctuation">(</span> img <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">end</span></span>
<span class="line">    img <span class="token operator">=</span> <span class="token function">double</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">%% constrcut patch tensor of original image</span></span>
<span class="line">    tenD <span class="token operator">=</span> <span class="token function">gen_patch_ten</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> patchSize<span class="token punctuation">,</span> slideStep<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">[</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">,</span>n3<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>tenD<span class="token punctuation">)</span><span class="token punctuation">;</span>  </span>
<span class="line">    </span>
<span class="line">    <span class="token comment">%% calculate prior weight map</span></span>
<span class="line">    <span class="token comment">%      step 1: calculate two eigenvalues from structure tensor</span></span>
<span class="line">    <span class="token punctuation">[</span>lambda1<span class="token punctuation">,</span> lambda2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">structure_tensor_lambda</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">%      step 2: calculate corner strength function</span></span>
<span class="line">    cornerStrength <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lambda1<span class="token operator">.*</span>lambda2<span class="token punctuation">)</span><span class="token operator">./</span><span class="token punctuation">(</span>lambda1 <span class="token operator">+</span> lambda2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">%      step 3: obtain final weight map</span></span>
<span class="line">    maxValue <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>lambda1<span class="token punctuation">,</span>lambda2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    priorWeight <span class="token operator">=</span> <span class="token function">mat2gray</span><span class="token punctuation">(</span>cornerStrength <span class="token operator">.*</span> maxValue<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">%      step 4: constrcut patch tensor of weight map</span></span>
<span class="line">    tenW <span class="token operator">=</span> <span class="token function">gen_patch_ten</span><span class="token punctuation">(</span>priorWeight<span class="token punctuation">,</span> patchSize<span class="token punctuation">,</span> slideStep<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">%% The proposed model</span></span>
<span class="line">    lambda <span class="token operator">=</span> lambdaL <span class="token operator">/</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">)</span><span class="token operator">*</span>n3<span class="token punctuation">)</span><span class="token punctuation">;</span> </span>
<span class="line">    <span class="token punctuation">[</span>tenB<span class="token punctuation">,</span>tenT<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">trpca_pstnn</span><span class="token punctuation">(</span>tenD<span class="token punctuation">,</span>lambda<span class="token punctuation">,</span>tenW<span class="token punctuation">)</span><span class="token punctuation">;</span> </span>
<span class="line">    </span>
<span class="line">    <span class="token comment">%% recover the target and background image</span></span>
<span class="line">    tarImg <span class="token operator">=</span> <span class="token function">res_patch_ten_mean</span><span class="token punctuation">(</span>tenT<span class="token punctuation">,</span> img<span class="token punctuation">,</span> patchSize<span class="token punctuation">,</span> slideStep<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    backImg <span class="token operator">=</span> <span class="token function">res_patch_ten_mean</span><span class="token punctuation">(</span>tenB<span class="token punctuation">,</span> img<span class="token punctuation">,</span> patchSize<span class="token punctuation">,</span> slideStep<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    maxv <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">double</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    E <span class="token operator">=</span> <span class="token function">uint8</span><span class="token punctuation">(</span> <span class="token function">mat2gray</span><span class="token punctuation">(</span>tarImg<span class="token punctuation">)</span><span class="token operator">*</span>maxv <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    A <span class="token operator">=</span> <span class="token function">uint8</span><span class="token punctuation">(</span> <span class="token function">mat2gray</span><span class="token punctuation">(</span>backImg<span class="token punctuation">)</span><span class="token operator">*</span>maxv <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">132</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>E<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">&#39;Target image&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">133</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">imshow</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">&#39;Background image&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">% save the results</span></span>
<span class="line">    <span class="token function">imwrite</span><span class="token punctuation">(</span>E<span class="token punctuation">,</span> <span class="token punctuation">[</span>saveDir <span class="token string">&#39;target/&#39;</span> <span class="token function">imgDir</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">imwrite</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token punctuation">[</span>saveDir <span class="token string">&#39;background/&#39;</span> <span class="token function">imgDir</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">% 滑动窗提取Patch</span></span>
<span class="line"><span class="token keyword">function</span> patchTen <span class="token operator">=</span> <span class="token function">gen_patch_ten</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> patchSize<span class="token punctuation">,</span> slideStep<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">% 2017-07-31</span></span>
<span class="line"><span class="token comment">% This matlab code implements the RIPT model for infrared target-background </span></span>
<span class="line"><span class="token comment">% separation.</span></span>
<span class="line">%</span>
<span class="line"><span class="token comment">% Yimian Dai. Questions? yimian.dai@gmail.com</span></span>
<span class="line"><span class="token comment">% Copyright: College of Electronic and Information Engineering, </span></span>
<span class="line"><span class="token comment">%            Nanjing University of Aeronautics and Astronautics</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> <span class="token operator">~</span><span class="token function">exist</span><span class="token punctuation">(</span><span class="token string">&#39;patchSize&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;var&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    patchSize <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> <span class="token operator">~</span><span class="token function">exist</span><span class="token punctuation">(</span><span class="token string">&#39;slideStep&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;var&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    slideStep <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">% img = reshape(1:9, [3 3])</span></span>
<span class="line"><span class="token comment">% img = reshape(1:12, [3 4])</span></span>
<span class="line"><span class="token comment">% patchSize = 2;</span></span>
<span class="line"><span class="token comment">% slideStep = 1;</span></span>
<span class="line"><span class="token punctuation">[</span>imgHei<span class="token punctuation">,</span> imgWid<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">rowPatchNum <span class="token operator">=</span> <span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>imgHei <span class="token operator">-</span> patchSize<span class="token punctuation">)</span> <span class="token operator">/</span> slideStep<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">colPatchNum <span class="token operator">=</span> <span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>imgWid <span class="token operator">-</span> patchSize<span class="token punctuation">)</span> <span class="token operator">/</span> slideStep<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">rowPosArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">:</span> slideStep <span class="token operator">:</span> <span class="token punctuation">(</span>rowPatchNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> slideStep<span class="token punctuation">,</span> imgHei <span class="token operator">-</span> patchSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">colPosArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">:</span> slideStep <span class="token operator">:</span> <span class="token punctuation">(</span>colPatchNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> slideStep<span class="token punctuation">,</span> imgWid <span class="token operator">-</span> patchSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">%% arrayfun version, identical to the following for-loop version</span></span>
<span class="line"><span class="token punctuation">[</span>meshCols<span class="token punctuation">,</span> meshRows<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">meshgrid</span><span class="token punctuation">(</span>colPosArr<span class="token punctuation">,</span> rowPosArr<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">idx_fun <span class="token operator">=</span> <span class="token operator">@</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span>col<span class="token punctuation">)</span> <span class="token function">img</span><span class="token punctuation">(</span>row <span class="token operator">:</span> row <span class="token operator">+</span> patchSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> col <span class="token operator">:</span> col <span class="token operator">+</span> patchSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">patchCell <span class="token operator">=</span> <span class="token function">arrayfun</span><span class="token punctuation">(</span>idx_fun<span class="token punctuation">,</span> meshRows<span class="token punctuation">,</span> meshCols<span class="token punctuation">,</span> <span class="token string">&#39;UniformOutput&#39;</span><span class="token punctuation">,</span> false<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">patchTen <span class="token operator">=</span> <span class="token function">cat</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> patchCell<span class="token punctuation">{</span><span class="token operator">:</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">%% for-loop version</span></span>
<span class="line"><span class="token comment">% patchTen = zeros(patchSize, patchSize, rowPatchNum * colPatchNum);</span></span>
<span class="line"><span class="token comment">% k = 0;</span></span>
<span class="line"><span class="token comment">% for col = colPosArr</span></span>
<span class="line"><span class="token comment">%     for row = rowPosArr</span></span>
<span class="line"><span class="token comment">%         k = k + 1;</span></span>
<span class="line"><span class="token comment">%         tmp_patch = img(row : row + patchSize - 1, col : col + patchSize - 1);</span></span>
<span class="line"><span class="token comment">%         patchTen(:, :, k) = tmp_patch;</span></span>
<span class="line"><span class="token comment">%     end</span></span>
<span class="line"><span class="token comment">% end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">% 计算结构化张量的特征值</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token punctuation">[</span>lambda_1<span class="token punctuation">,</span> lambda_2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">structure_tensor_lambda</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> sz<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">G <span class="token operator">=</span> <span class="token function">fspecial</span><span class="token punctuation">(</span><span class="token string">&#39;gaussian&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>sz sz<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% Gaussian kernel</span></span>
<span class="line">u <span class="token operator">=</span> <span class="token function">imfilter</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> G<span class="token punctuation">,</span> <span class="token string">&#39;symmetric&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">[</span>Gx<span class="token punctuation">,</span> Gy<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">gradient</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">K <span class="token operator">=</span> <span class="token function">fspecial</span><span class="token punctuation">(</span><span class="token string">&#39;gaussian&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>sz sz<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% Gaussian kernel</span></span>
<span class="line">J_11 <span class="token operator">=</span> <span class="token function">imfilter</span><span class="token punctuation">(</span>Gx<span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">,</span> K<span class="token punctuation">,</span> <span class="token string">&#39;symmetric&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span>
<span class="line">J_12 <span class="token operator">=</span> <span class="token function">imfilter</span><span class="token punctuation">(</span>Gx<span class="token operator">.*</span>Gy<span class="token punctuation">,</span> K<span class="token punctuation">,</span> <span class="token string">&#39;symmetric&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">J_21 <span class="token operator">=</span> J_12<span class="token punctuation">;</span></span>
<span class="line">J_22 <span class="token operator">=</span> <span class="token function">imfilter</span><span class="token punctuation">(</span>Gy<span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">,</span> K<span class="token punctuation">,</span> <span class="token string">&#39;symmetric&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   </span>
<span class="line"></span>
<span class="line">sqrt_delta <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>J_11 <span class="token operator">-</span> J_22<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token operator">*</span>J_12<span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">lambda_1 <span class="token operator">=</span> <span class="token number">0.5</span><span class="token operator">*</span><span class="token punctuation">(</span>J_11 <span class="token operator">+</span> J_22 <span class="token operator">+</span> sqrt_delta<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">lambda_2 <span class="token operator">=</span> <span class="token number">0.5</span><span class="token operator">*</span><span class="token punctuation">(</span>J_11 <span class="token operator">+</span> J_22 <span class="token operator">-</span> sqrt_delta<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">% 计算目标和背景</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token punctuation">[</span>L<span class="token punctuation">,</span>S<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">trpca_pstnn</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> lambda<span class="token punctuation">,</span> tenW<span class="token punctuation">,</span> opts<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">tol <span class="token operator">=</span> <span class="token number">1e-3</span><span class="token punctuation">;</span> </span>
<span class="line">max_iter <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span></span>
<span class="line">rho <span class="token operator">=</span> <span class="token number">1.05</span><span class="token punctuation">;</span></span>
<span class="line">mu <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span><span class="token number">1e-3</span><span class="token punctuation">;</span></span>
<span class="line">max_mu <span class="token operator">=</span> <span class="token number">1e10</span><span class="token punctuation">;</span></span>
<span class="line">DEBUG <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">N <span class="token operator">=</span> <span class="token function">rankN</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> <span class="token operator">~</span><span class="token function">exist</span><span class="token punctuation">(</span><span class="token string">&#39;opts&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;var&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    opts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">end</span>    </span>
<span class="line"><span class="token keyword">if</span> <span class="token function">isfield</span><span class="token punctuation">(</span>opts<span class="token punctuation">,</span> <span class="token string">&#39;tol&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         tol <span class="token operator">=</span> opts<span class="token punctuation">.</span>tol<span class="token punctuation">;</span>              <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token function">isfield</span><span class="token punctuation">(</span>opts<span class="token punctuation">,</span> <span class="token string">&#39;max_iter&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    max_iter <span class="token operator">=</span> opts<span class="token punctuation">.</span>max_iter<span class="token punctuation">;</span>    <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token function">isfield</span><span class="token punctuation">(</span>opts<span class="token punctuation">,</span> <span class="token string">&#39;rho&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         rho <span class="token operator">=</span> opts<span class="token punctuation">.</span>rho<span class="token punctuation">;</span>              <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token function">isfield</span><span class="token punctuation">(</span>opts<span class="token punctuation">,</span> <span class="token string">&#39;mu&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          mu <span class="token operator">=</span> opts<span class="token punctuation">.</span>mu<span class="token punctuation">;</span>                <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token function">isfield</span><span class="token punctuation">(</span>opts<span class="token punctuation">,</span> <span class="token string">&#39;max_mu&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      max_mu <span class="token operator">=</span> opts<span class="token punctuation">.</span>max_mu<span class="token punctuation">;</span>        <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token function">isfield</span><span class="token punctuation">(</span>opts<span class="token punctuation">,</span> <span class="token string">&#39;DEBUG&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       DEBUG <span class="token operator">=</span> opts<span class="token punctuation">.</span>DEBUG<span class="token punctuation">;</span>          <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token function">isfield</span><span class="token punctuation">(</span>opts<span class="token punctuation">,</span> <span class="token string">&#39;N&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           N <span class="token operator">=</span> opts<span class="token punctuation">.</span>N<span class="token punctuation">;</span>                  <span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">dim <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">L <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>dim<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">S <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>dim<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">Y <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>dim<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">weightTen <span class="token operator">=</span> <span class="token function">ones</span><span class="token punctuation">(</span>dim<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">for</span> iter <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">:</span> max_iter</span>
<span class="line">    </span>
<span class="line">    preT <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token function">S</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">% update L</span></span>
<span class="line">    R <span class="token operator">=</span> <span class="token operator">-</span>S<span class="token operator">+</span>X<span class="token operator">-</span>Y<span class="token operator">/</span>mu<span class="token punctuation">;</span></span>
<span class="line">    L <span class="token operator">=</span> <span class="token function">prox_pstnn</span><span class="token punctuation">(</span>R<span class="token punctuation">,</span>N<span class="token punctuation">,</span>mu<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment">% update S</span></span>
<span class="line">    T <span class="token operator">=</span> <span class="token operator">-</span>L<span class="token operator">+</span>X<span class="token operator">-</span>Y<span class="token operator">/</span>mu<span class="token punctuation">;</span></span>
<span class="line">    S <span class="token operator">=</span> <span class="token function">prox_l1</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> weightTen<span class="token operator">*</span>lambda<span class="token operator">/</span>mu<span class="token punctuation">)</span><span class="token punctuation">;</span>    </span>
<span class="line">    weightTen <span class="token operator">=</span> N<span class="token operator">./</span> <span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token operator">./</span>tenW<span class="token punctuation">;</span></span>
<span class="line">  </span>
<span class="line">    dY <span class="token operator">=</span> L<span class="token operator">+</span>S<span class="token operator">-</span>X<span class="token punctuation">;</span></span>
<span class="line">    err <span class="token operator">=</span> <span class="token function">norm</span><span class="token punctuation">(</span><span class="token function">dY</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> DEBUG</span>
<span class="line">        <span class="token keyword">if</span> iter <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token function">mod</span><span class="token punctuation">(</span>iter<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>            </span>
<span class="line">            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;iter &#39;</span> <span class="token function">num2str</span><span class="token punctuation">(</span>iter<span class="token punctuation">)</span> <span class="token string">&#39;, mu=&#39;</span> <span class="token function">num2str</span><span class="token punctuation">(</span>mu<span class="token punctuation">)</span> <span class="token punctuation">...</span></span>
<span class="line">                   <span class="token string">&#39;, err=&#39;</span> <span class="token function">num2str</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">...</span></span>
<span class="line">                    <span class="token string">&#39;,|T|0 = &#39;</span> <span class="token function">num2str</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token function">S</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span>
<span class="line">        <span class="token keyword">end</span></span>
<span class="line">    <span class="token keyword">end</span></span>
<span class="line">    currT <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token function">S</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> err <span class="token operator">&lt;</span> tol <span class="token operator">||</span> <span class="token punctuation">(</span>preT<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> currT<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> preT <span class="token operator">==</span> currT<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">end</span> </span>
<span class="line">    Y <span class="token operator">=</span> Y <span class="token operator">+</span> dY<span class="token operator">*</span>mu<span class="token punctuation">;</span></span>
<span class="line">    mu <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>rho<span class="token operator">*</span>mu<span class="token punctuation">,</span>max_mu<span class="token punctuation">)</span><span class="token punctuation">;</span>    </span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">% 估计矩阵的秩</span></span>
<span class="line"><span class="token keyword">function</span> N <span class="token operator">=</span> <span class="token function">rankN</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> ratioN<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span><span class="token operator">~</span><span class="token punctuation">,</span>n3<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    D <span class="token operator">=</span> <span class="token function">Unfold</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>n3<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">,</span> S<span class="token punctuation">,</span> <span class="token operator">~</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">svd</span><span class="token punctuation">(</span>D<span class="token punctuation">,</span> <span class="token string">&#39;econ&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">[</span>desS<span class="token punctuation">,</span> <span class="token operator">~</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sort</span><span class="token punctuation">(</span><span class="token function">diag</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;descend&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    ratioVec <span class="token operator">=</span> desS <span class="token operator">/</span> <span class="token function">desS</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    idxArr <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>ratioVec <span class="token operator">&lt;</span> ratioN<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token function">idxArr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span></span>
<span class="line">        N <span class="token operator">=</span> <span class="token function">idxArr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">else</span></span>
<span class="line">        N <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line">    </span>
<span class="line">    </span>
<span class="line"><span class="token comment">% 核范数的优化</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token punctuation">[</span>X<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">prox_pstnn</span><span class="token punctuation">(</span>Y<span class="token punctuation">,</span>N<span class="token punctuation">,</span>mu<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">[</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">,</span>n3<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">X <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">,</span>n3<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">Y <span class="token operator">=</span> <span class="token function">fft</span><span class="token punctuation">(</span>Y<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">tau <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>mu<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">% first frontal slice</span></span>
<span class="line"><span class="token punctuation">[</span>U<span class="token punctuation">,</span>S<span class="token punctuation">,</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">svd</span><span class="token punctuation">(</span><span class="token function">Y</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&#39;econ&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">diagS <span class="token operator">=</span> <span class="token function">diag</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">[</span>desS<span class="token punctuation">,</span> sIdx<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sort</span><span class="token punctuation">(</span>diagS<span class="token punctuation">,</span> <span class="token string">&#39;descend&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">[</span>desU<span class="token punctuation">,</span> desV<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deal</span><span class="token punctuation">(</span><span class="token function">U</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> sIdx<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">V</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> sIdx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">[</span>U1<span class="token punctuation">,</span> diagS1<span class="token punctuation">,</span> V1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deal</span><span class="token punctuation">(</span><span class="token function">desU</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">desS</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">desV</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">[</span>U2<span class="token punctuation">,</span> diagS2<span class="token punctuation">,</span> V2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deal</span><span class="token punctuation">(</span><span class="token function">desU</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">desS</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">desV</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span>
<span class="line">threshS2 <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>diagS2<span class="token operator">-</span>tau<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span>
<span class="line"><span class="token function">X</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> U1<span class="token operator">*</span><span class="token function">diag</span><span class="token punctuation">(</span>diagS1<span class="token punctuation">)</span><span class="token operator">*</span>V1<span class="token operator">&#39;</span> <span class="token operator">+</span> U2<span class="token operator">*</span><span class="token function">diag</span><span class="token punctuation">(</span>threshS2<span class="token punctuation">)</span><span class="token operator">*</span>V2<span class="token operator">&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">% i=2,...,halfn3</span></span>
<span class="line">halfn3 <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>n3<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">:</span> halfn3</span>
<span class="line">    <span class="token punctuation">[</span>U<span class="token punctuation">,</span>S<span class="token punctuation">,</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">svd</span><span class="token punctuation">(</span><span class="token function">Y</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&#39;econ&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    diagS <span class="token operator">=</span> <span class="token function">diag</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">[</span>desS<span class="token punctuation">,</span> sIdx<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sort</span><span class="token punctuation">(</span>diagS<span class="token punctuation">,</span> <span class="token string">&#39;descend&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">[</span>desU<span class="token punctuation">,</span> desV<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deal</span><span class="token punctuation">(</span><span class="token function">U</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> sIdx<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">V</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> sIdx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">[</span>U1<span class="token punctuation">,</span> diagS1<span class="token punctuation">,</span> V1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deal</span><span class="token punctuation">(</span><span class="token function">desU</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">desS</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">desV</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">[</span>U2<span class="token punctuation">,</span> diagS2<span class="token punctuation">,</span> V2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deal</span><span class="token punctuation">(</span><span class="token function">desU</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">desS</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">desV</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span>
<span class="line">    threshS2 <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>diagS2<span class="token operator">-</span>tau<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span>
<span class="line">    <span class="token function">X</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">=</span> U1<span class="token operator">*</span><span class="token function">diag</span><span class="token punctuation">(</span>diagS1<span class="token punctuation">)</span><span class="token operator">*</span>V1<span class="token operator">&#39;</span> <span class="token operator">+</span> U2<span class="token operator">*</span><span class="token function">diag</span><span class="token punctuation">(</span>threshS2<span class="token punctuation">)</span><span class="token operator">*</span>V2<span class="token operator">&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">X</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span>n3<span class="token operator">+</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">conj</span><span class="token punctuation">(</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line">  </span>
<span class="line"><span class="token comment">% if n3 is even</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token function">mod</span><span class="token punctuation">(</span>n3<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span></span>
<span class="line">    <span class="token number">i</span> <span class="token operator">=</span> halfn3<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">[</span>U<span class="token punctuation">,</span>S<span class="token punctuation">,</span>V<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">svd</span><span class="token punctuation">(</span><span class="token function">Y</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&#39;econ&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    diagS <span class="token operator">=</span> <span class="token function">diag</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">[</span>desS<span class="token punctuation">,</span> sIdx<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sort</span><span class="token punctuation">(</span>diagS<span class="token punctuation">,</span> <span class="token string">&#39;descend&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">[</span>desU<span class="token punctuation">,</span> desV<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deal</span><span class="token punctuation">(</span><span class="token function">U</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> sIdx<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">V</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> sIdx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">[</span>U1<span class="token punctuation">,</span> diagS1<span class="token punctuation">,</span> V1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deal</span><span class="token punctuation">(</span><span class="token function">desU</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">desS</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">desV</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">[</span>U2<span class="token punctuation">,</span> diagS2<span class="token punctuation">,</span> V2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deal</span><span class="token punctuation">(</span><span class="token function">desU</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">desS</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">desV</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span>
<span class="line">    threshS2 <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>diagS2<span class="token operator">-</span>tau<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span>
<span class="line">    <span class="token function">X</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">=</span> U1<span class="token operator">*</span><span class="token function">diag</span><span class="token punctuation">(</span>diagS1<span class="token punctuation">)</span><span class="token operator">*</span>V1<span class="token operator">&#39;</span> <span class="token operator">+</span> U2<span class="token operator">*</span><span class="token function">diag</span><span class="token punctuation">(</span>threshS2<span class="token punctuation">)</span><span class="token operator">*</span>V2<span class="token operator">&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">X <span class="token operator">=</span> <span class="token function">ifft</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">% 1范数的优化</span></span>
<span class="line"><span class="token keyword">function</span> x <span class="token operator">=</span> <span class="token function">prox_l1</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>lambda<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">x <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>b<span class="token operator">-</span>lambda<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>b<span class="token operator">+</span>lambda<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">x <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">% 合并面片为图像</span></span>
<span class="line"><span class="token keyword">function</span> recImg <span class="token operator">=</span> <span class="token function">res_patch_ten_mean</span><span class="token punctuation">(</span>patchTen<span class="token punctuation">,</span> img<span class="token punctuation">,</span> patchSize<span class="token punctuation">,</span> slideStep<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">% 2017-07-31</span></span>
<span class="line"><span class="token comment">% This matlab code implements the RIPT model for infrared target-background </span></span>
<span class="line"><span class="token comment">% separation.</span></span>
<span class="line">%</span>
<span class="line"><span class="token comment">% Yimian Dai. Questions? yimian.dai@gmail.com</span></span>
<span class="line"><span class="token comment">% Copyright: College of Electronic and Information Engineering, </span></span>
<span class="line"><span class="token comment">%            Nanjing University of Aeronautics and Astronautics</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">[</span>imgHei<span class="token punctuation">,</span> imgWid<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">rowPatchNum <span class="token operator">=</span> <span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>imgHei <span class="token operator">-</span> patchSize<span class="token punctuation">)</span> <span class="token operator">/</span> slideStep<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">colPatchNum <span class="token operator">=</span> <span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>imgWid <span class="token operator">-</span> patchSize<span class="token punctuation">)</span> <span class="token operator">/</span> slideStep<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">rowPosArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">:</span> slideStep <span class="token operator">:</span> <span class="token punctuation">(</span>rowPatchNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> slideStep<span class="token punctuation">,</span> imgHei <span class="token operator">-</span> patchSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">colPosArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">:</span> slideStep <span class="token operator">:</span> <span class="token punctuation">(</span>colPatchNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> slideStep<span class="token punctuation">,</span> imgWid <span class="token operator">-</span> patchSize <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">%% for-loop version</span></span>
<span class="line">accImg <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>imgHei<span class="token punctuation">,</span> imgWid<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">weiImg <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>imgHei<span class="token punctuation">,</span> imgWid<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">onesMat <span class="token operator">=</span> <span class="token function">ones</span><span class="token punctuation">(</span>patchSize<span class="token punctuation">,</span> patchSize<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">for</span> col <span class="token operator">=</span> colPosArr</span>
<span class="line">    <span class="token keyword">for</span> row <span class="token operator">=</span> rowPosArr</span>
<span class="line">        k <span class="token operator">=</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">        tmpPatch <span class="token operator">=</span> <span class="token function">reshape</span><span class="token punctuation">(</span><span class="token function">patchTen</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token operator">:</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>patchSize<span class="token punctuation">,</span> patchSize<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">accImg</span><span class="token punctuation">(</span>row <span class="token operator">:</span> row <span class="token operator">+</span> patchSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> col <span class="token operator">:</span> col <span class="token operator">+</span> patchSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> tmpPatch<span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">weiImg</span><span class="token punctuation">(</span>row <span class="token operator">:</span> row <span class="token operator">+</span> patchSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> col <span class="token operator">:</span> col <span class="token operator">+</span> patchSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> onesMat<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">recImg <span class="token operator">=</span> accImg <span class="token operator">./</span> weiImg<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="根据matlab代码自己写的python代码" tabindex="-1"><a class="header-anchor" href="#根据matlab代码自己写的python代码"><span>根据matlab代码自己写的python代码</span></a></h4><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt</span>
<span class="line"><span class="token keyword">import</span> cv2</span>
<span class="line"><span class="token keyword">import</span> math</span>
<span class="line"><span class="token keyword">import</span> scipy</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">init</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    pic <span class="token operator">=</span> plt<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>path<span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">131</span><span class="token punctuation">)</span></span>
<span class="line">    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&#39;Original&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> pic<span class="token punctuation">.</span>ndim <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span></span>
<span class="line">        plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>pic<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">&#39;gray&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> pic<span class="token punctuation">.</span>ndim <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span></span>
<span class="line">        plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>pic<span class="token punctuation">)</span></span>
<span class="line">        pic <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>pic<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_RGB2GRAY<span class="token punctuation">)</span></span>
<span class="line">    pic <span class="token operator">=</span> np<span class="token punctuation">.</span>float64<span class="token punctuation">(</span>pic<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> pic</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">gen_patch</span><span class="token punctuation">(</span>pic<span class="token punctuation">,</span> patch_size<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">,</span> slide_step<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line"></span>
<span class="line">    pic_H<span class="token punctuation">,</span> pic_W <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>pic<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">    row_patch_num <span class="token operator">=</span> math<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span><span class="token punctuation">(</span>pic_H <span class="token operator">-</span> patch_size<span class="token punctuation">)</span> <span class="token operator">/</span> slide_step <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    col_patch_num <span class="token operator">=</span> math<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span><span class="token punctuation">(</span>pic_W <span class="token operator">-</span> patch_size<span class="token punctuation">)</span> <span class="token operator">/</span> slide_step <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    row_pos_arr <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> slide_step <span class="token operator">*</span> <span class="token punctuation">(</span>row_patch_num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> slide_step<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    row_pos_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pic_H <span class="token operator">-</span> patch_size<span class="token punctuation">)</span></span>
<span class="line">    col_pos_arr <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> slide_step <span class="token operator">*</span> <span class="token punctuation">(</span>col_patch_num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> slide_step<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    col_pos_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pic_W <span class="token operator">-</span> patch_size<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    Patch <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>patch_size<span class="token punctuation">,</span> patch_size<span class="token punctuation">,</span> row_patch_num <span class="token operator">*</span> col_patch_num<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    k <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">    <span class="token keyword">for</span> j <span class="token keyword">in</span> col_pos_arr<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">for</span> i <span class="token keyword">in</span> row_pos_arr<span class="token punctuation">:</span></span>
<span class="line">            patch_cell <span class="token operator">=</span> pic<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> patch_size<span class="token punctuation">,</span> j<span class="token punctuation">:</span>j <span class="token operator">+</span> patch_size<span class="token punctuation">]</span></span>
<span class="line">            Patch<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> k<span class="token punctuation">]</span> <span class="token operator">=</span> patch_cell</span>
<span class="line">            k <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> Patch</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">res_patch</span><span class="token punctuation">(</span>patch<span class="token punctuation">,</span> pic<span class="token punctuation">,</span> patch_size<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">,</span> slide_step<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line"></span>
<span class="line">    pic_H<span class="token punctuation">,</span> pic_W <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>pic<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">    row_patch_num <span class="token operator">=</span> math<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span><span class="token punctuation">(</span>pic_H <span class="token operator">-</span> patch_size<span class="token punctuation">)</span> <span class="token operator">/</span> slide_step <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    col_patch_num <span class="token operator">=</span> math<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span><span class="token punctuation">(</span>pic_W <span class="token operator">-</span> patch_size<span class="token punctuation">)</span> <span class="token operator">/</span> slide_step <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    row_pos_arr <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> slide_step <span class="token operator">*</span> <span class="token punctuation">(</span>row_patch_num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> slide_step<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    row_pos_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pic_H <span class="token operator">-</span> patch_size<span class="token punctuation">)</span></span>
<span class="line">    col_pos_arr <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> slide_step <span class="token operator">*</span> <span class="token punctuation">(</span>col_patch_num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> slide_step<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    col_pos_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pic_W <span class="token operator">-</span> patch_size<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    accImg <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>pic_H<span class="token punctuation">,</span> pic_W<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    weiImg <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>pic_H<span class="token punctuation">,</span> pic_W<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    onesMat <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span>patch_size<span class="token punctuation">,</span> patch_size<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    k <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">    <span class="token keyword">for</span> j <span class="token keyword">in</span> col_pos_arr<span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">for</span> i <span class="token keyword">in</span> row_pos_arr<span class="token punctuation">:</span></span>
<span class="line">            tempPatch <span class="token operator">=</span> np<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>patch<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> k<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>patch_size<span class="token punctuation">,</span> patch_size<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            accImg<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span>patch_size<span class="token punctuation">,</span> j<span class="token punctuation">:</span>j<span class="token operator">+</span>patch_size<span class="token punctuation">]</span> <span class="token operator">=</span> tempPatch</span>
<span class="line">            weiImg<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span>patch_size<span class="token punctuation">,</span> j<span class="token punctuation">:</span>j<span class="token operator">+</span>patch_size<span class="token punctuation">]</span> <span class="token operator">=</span> onesMat</span>
<span class="line">            k <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> accImg <span class="token operator">/</span> weiImg</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">structure_tensor_lambda</span><span class="token punctuation">(</span>pic<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    Gaussian_kernel <span class="token operator">=</span> cv2<span class="token punctuation">.</span>getGaussianKernel<span class="token punctuation">(</span>size<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> @ cv2<span class="token punctuation">.</span>getGaussianKernel<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T</span>
<span class="line">    u <span class="token operator">=</span> scipy<span class="token punctuation">.</span>ndimage<span class="token punctuation">.</span>convolve<span class="token punctuation">(</span>pic<span class="token punctuation">,</span> Gaussian_kernel<span class="token punctuation">)</span>  </span>
<span class="line">    Gx<span class="token punctuation">,</span> Gy <span class="token operator">=</span> np<span class="token punctuation">.</span>gradient<span class="token punctuation">(</span>u<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    Gaussian_kernel <span class="token operator">=</span> cv2<span class="token punctuation">.</span>getGaussianKernel<span class="token punctuation">(</span>size<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span> @ cv2<span class="token punctuation">.</span>getGaussianKernel<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T</span>
<span class="line">    J_11 <span class="token operator">=</span> scipy<span class="token punctuation">.</span>ndimage<span class="token punctuation">.</span>convolve<span class="token punctuation">(</span>Gx <span class="token operator">*</span> Gx<span class="token punctuation">,</span> Gaussian_kernel<span class="token punctuation">)</span></span>
<span class="line">    J_12 <span class="token operator">=</span> scipy<span class="token punctuation">.</span>ndimage<span class="token punctuation">.</span>convolve<span class="token punctuation">(</span>Gx <span class="token operator">*</span> Gy<span class="token punctuation">,</span> Gaussian_kernel<span class="token punctuation">)</span></span>
<span class="line">    J_21 <span class="token operator">=</span> J_12</span>
<span class="line">    J_22 <span class="token operator">=</span> scipy<span class="token punctuation">.</span>ndimage<span class="token punctuation">.</span>convolve<span class="token punctuation">(</span>Gy <span class="token operator">*</span> Gy<span class="token punctuation">,</span> Gaussian_kernel<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    sqrt_delta <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>J_11 <span class="token operator">-</span> J_22<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">(</span>J_12 <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">    lambda1 <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token operator">*</span> <span class="token punctuation">(</span>J_11 <span class="token operator">+</span> J_22 <span class="token operator">+</span> sqrt_delta<span class="token punctuation">)</span></span>
<span class="line">    lambda2 <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token operator">*</span> <span class="token punctuation">(</span>J_11 <span class="token operator">+</span> J_22 <span class="token operator">-</span> sqrt_delta<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> lambda1<span class="token punctuation">,</span> lambda2</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">prox_pstnn</span><span class="token punctuation">(</span>Y<span class="token punctuation">,</span> N<span class="token punctuation">,</span> mu<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    dim <span class="token operator">=</span> Y<span class="token punctuation">.</span>shape</span>
<span class="line">    X <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>dim<span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">&#39;complex&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    Y <span class="token operator">=</span> np<span class="token punctuation">.</span>fft<span class="token punctuation">.</span>fft<span class="token punctuation">(</span>Y<span class="token punctuation">)</span></span>
<span class="line">    tau <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> mu</span>
<span class="line"></span>
<span class="line">    U<span class="token punctuation">,</span> diagS<span class="token punctuation">,</span> V <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>svd<span class="token punctuation">(</span>Y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    des_S <span class="token operator">=</span> np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>diagS<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">    idx_S <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>diagS<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">    des_U<span class="token punctuation">,</span> des_V <span class="token operator">=</span> U<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> idx_S<span class="token punctuation">]</span><span class="token punctuation">,</span> V<span class="token punctuation">.</span>T<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> idx_S<span class="token punctuation">]</span></span>
<span class="line">    U1<span class="token punctuation">,</span> diagS1<span class="token punctuation">,</span> V1 <span class="token operator">=</span> des_U<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> des_S<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> des_V<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">    U2<span class="token punctuation">,</span> diagS2<span class="token punctuation">,</span> V2 <span class="token operator">=</span> des_U<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> des_S<span class="token punctuation">[</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> des_V<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">    threshS2 <span class="token operator">=</span> np<span class="token punctuation">.</span>fmax<span class="token punctuation">(</span>diagS2 <span class="token operator">-</span> tau<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> U1 @ np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>diagS1<span class="token punctuation">)</span> @ V1<span class="token punctuation">.</span>T <span class="token operator">+</span> U2 @ np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>threshS2<span class="token punctuation">)</span> @ V2<span class="token punctuation">.</span>T</span>
<span class="line"></span>
<span class="line">    half_n3 <span class="token operator">=</span> <span class="token builtin">round</span><span class="token punctuation">(</span>dim<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> half_n3 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        U<span class="token punctuation">,</span> diagS<span class="token punctuation">,</span> V <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>svd<span class="token punctuation">(</span>Y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">        des_S <span class="token operator">=</span> np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>diagS<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">        idx_S <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>diagS<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">        des_U<span class="token punctuation">,</span> des_V <span class="token operator">=</span> U<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> idx_S<span class="token punctuation">]</span><span class="token punctuation">,</span> V<span class="token punctuation">.</span>T<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> idx_S<span class="token punctuation">]</span></span>
<span class="line">        U1<span class="token punctuation">,</span> diagS1<span class="token punctuation">,</span> V1 <span class="token operator">=</span> des_U<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> des_S<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> des_V<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">        U2<span class="token punctuation">,</span> diagS2<span class="token punctuation">,</span> V2 <span class="token operator">=</span> des_U<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> des_S<span class="token punctuation">[</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> des_V<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">        threshS2 <span class="token operator">=</span> np<span class="token punctuation">.</span>fmax<span class="token punctuation">(</span>diagS2 <span class="token operator">-</span> tau<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> U1 @ np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>diagS1<span class="token punctuation">)</span> @ V1<span class="token punctuation">.</span>T <span class="token operator">+</span> U2 @ np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>threshS2<span class="token punctuation">)</span> @ V2<span class="token punctuation">.</span>T</span>
<span class="line">        X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> dim<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>conj<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">if</span> dim<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">        i <span class="token operator">=</span> half_n3 <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line">        U<span class="token punctuation">,</span> diagS<span class="token punctuation">,</span> V <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>svd<span class="token punctuation">(</span>Y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">        des_S <span class="token operator">=</span> np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>diagS<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">        idx_S <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>diagS<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">        des_U<span class="token punctuation">,</span> des_V <span class="token operator">=</span> U<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> idx_S<span class="token punctuation">]</span><span class="token punctuation">,</span> V<span class="token punctuation">.</span>T<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> idx_S<span class="token punctuation">]</span></span>
<span class="line">        U1<span class="token punctuation">,</span> diagS1<span class="token punctuation">,</span> V1 <span class="token operator">=</span> des_U<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> des_S<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> des_V<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span>N <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">        U2<span class="token punctuation">,</span> diagS2<span class="token punctuation">,</span> V2 <span class="token operator">=</span> des_U<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> des_S<span class="token punctuation">[</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> des_V<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span></span>
<span class="line">        threshS2 <span class="token operator">=</span> np<span class="token punctuation">.</span>fmax<span class="token punctuation">(</span>diagS2 <span class="token operator">-</span> tau<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> U1 @ np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>diagS1<span class="token punctuation">)</span> @ V1<span class="token punctuation">.</span>T <span class="token operator">+</span> U2 @ np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>threshS2<span class="token punctuation">)</span> @ V2<span class="token punctuation">.</span>T</span>
<span class="line"></span>
<span class="line">    X <span class="token operator">=</span> np<span class="token punctuation">.</span>fft<span class="token punctuation">.</span>ifft<span class="token punctuation">(</span>X<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> X<span class="token punctuation">.</span>real</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">prox_l1</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> lambda_<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    x <span class="token operator">=</span> np<span class="token punctuation">.</span>fmax<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> b <span class="token operator">-</span> lambda_<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>fmin<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> b <span class="token operator">+</span> lambda_<span class="token punctuation">)</span></span>
<span class="line">    x <span class="token operator">=</span> np<span class="token punctuation">.</span>fmax<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> x</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">rankN</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> ration_n<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line"></span>
<span class="line">    num3 <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span></span>
<span class="line">    re_x <span class="token operator">=</span> x<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>num3<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token string">&#39;F&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    S_diag <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>svd<span class="token punctuation">(</span>re_x<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">    des_S <span class="token operator">=</span> np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>S_diag<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">    ratioVec <span class="token operator">=</span> des_S <span class="token operator">/</span> des_S<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">    idxArr <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>ratioVec <span class="token operator">&lt;</span> ration_n<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">if</span> idxArr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span></span>
<span class="line">        N <span class="token operator">=</span> idxArr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        N <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> N</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">trpca_pstnn</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> lambda_<span class="token punctuation">,</span> tenW<span class="token punctuation">,</span> tol<span class="token operator">=</span><span class="token number">1e-3</span><span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> rho<span class="token operator">=</span><span class="token number">1.05</span><span class="token punctuation">,</span> mu<span class="token operator">=</span><span class="token number">2e-3</span><span class="token punctuation">,</span> max_mu<span class="token operator">=</span><span class="token number">1e10</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line"></span>
<span class="line">    N <span class="token operator">=</span> rankN<span class="token punctuation">(</span>X<span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    dim <span class="token operator">=</span> np<span class="token punctuation">.</span>shape<span class="token punctuation">(</span>X<span class="token punctuation">)</span></span>
<span class="line">    L <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>dim<span class="token punctuation">)</span></span>
<span class="line">    S <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>dim<span class="token punctuation">)</span></span>
<span class="line">    Y <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>dim<span class="token punctuation">)</span></span>
<span class="line">    weightTen <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>dim<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">for</span> <span class="token builtin">iter</span> <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>max_iter<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        preT <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>S <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        R <span class="token operator">=</span> <span class="token operator">-</span>S <span class="token operator">+</span> X <span class="token operator">-</span> Y <span class="token operator">/</span> mu</span>
<span class="line">        L <span class="token operator">=</span> prox_pstnn<span class="token punctuation">(</span>R<span class="token punctuation">,</span> N<span class="token punctuation">,</span> mu<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        T <span class="token operator">=</span> <span class="token operator">-</span>L <span class="token operator">+</span> X <span class="token operator">-</span> Y <span class="token operator">/</span> mu</span>
<span class="line">        S <span class="token operator">=</span> prox_l1<span class="token punctuation">(</span>T<span class="token punctuation">,</span> weightTen <span class="token operator">*</span> lambda_ <span class="token operator">/</span> mu<span class="token punctuation">)</span></span>
<span class="line">        weightTen <span class="token operator">=</span> N<span class="token operator">+</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.01</span><span class="token punctuation">)</span> <span class="token operator">/</span> tenW</span>
<span class="line"></span>
<span class="line">        dY <span class="token operator">=</span> L <span class="token operator">+</span> S <span class="token operator">-</span> X</span>
<span class="line">        err <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>dY<span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>X<span class="token punctuation">)</span></span>
<span class="line">        currT <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>S<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span> debug<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;iter: %d , mu: %.4f, err: %.4f, |T|0: %d&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">iter</span><span class="token punctuation">,</span> mu<span class="token punctuation">,</span> err<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>currT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span> err <span class="token operator">&lt;</span> tol <span class="token keyword">or</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;</span> preT <span class="token operator">==</span> currT <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">break</span></span>
<span class="line"></span>
<span class="line">        Y <span class="token operator">=</span> Y <span class="token operator">+</span> dY <span class="token operator">*</span> mu</span>
<span class="line">        mu <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>rho <span class="token operator">*</span> mu<span class="token punctuation">,</span> max_mu<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> L<span class="token punctuation">,</span> S</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">lambdaL <span class="token operator">=</span> <span class="token number">0.7</span></span>
<span class="line"></span>
<span class="line">img <span class="token operator">=</span> init<span class="token punctuation">(</span><span class="token string">&quot;./1.bmp&quot;</span><span class="token punctuation">)</span></span>
<span class="line">D <span class="token operator">=</span> gen_patch<span class="token punctuation">(</span>img<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">n1<span class="token punctuation">,</span> n2<span class="token punctuation">,</span> n3 <span class="token operator">=</span> D<span class="token punctuation">.</span>shape</span>
<span class="line"></span>
<span class="line">lambDa1<span class="token punctuation">,</span> lambDa2 <span class="token operator">=</span> structure_tensor_lambda<span class="token punctuation">(</span>img<span class="token punctuation">)</span></span>
<span class="line">cornerStrength <span class="token operator">=</span> <span class="token punctuation">(</span>lambDa1 <span class="token operator">*</span> lambDa2<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>lambDa1 <span class="token operator">+</span> lambDa2<span class="token punctuation">)</span></span>
<span class="line">maxValue <span class="token operator">=</span> np<span class="token punctuation">.</span>maximum<span class="token punctuation">(</span>lambDa1<span class="token punctuation">,</span> lambDa2<span class="token punctuation">)</span>  </span>
<span class="line">priorWeight <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>maxValue<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> np<span class="token punctuation">.</span>float64<span class="token punctuation">)</span></span>
<span class="line">cv2<span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>cornerStrength <span class="token operator">*</span> maxValue<span class="token punctuation">,</span> priorWeight<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>NORM_MINMAX<span class="token punctuation">,</span> dtype<span class="token operator">=</span>cv2<span class="token punctuation">.</span>CV_64F<span class="token punctuation">)</span>  </span>
<span class="line">W <span class="token operator">=</span> gen_patch<span class="token punctuation">(</span>priorWeight<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">lambda0 <span class="token operator">=</span> lambdaL <span class="token operator">/</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span> <span class="token operator">*</span> n3<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">B<span class="token punctuation">,</span> T_ <span class="token operator">=</span> trpca_pstnn<span class="token punctuation">(</span>D<span class="token punctuation">,</span> lambda0<span class="token punctuation">,</span> W<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">tarImg <span class="token operator">=</span> res_patch<span class="token punctuation">(</span>T_<span class="token punctuation">,</span> img<span class="token punctuation">)</span></span>
<span class="line">backImg <span class="token operator">=</span> res_patch<span class="token punctuation">(</span>B<span class="token punctuation">,</span> img<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">maxV <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span></span>
<span class="line">E <span class="token operator">=</span> cv2<span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>tarImg<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>NORM_MINMAX<span class="token punctuation">,</span> dtype<span class="token operator">=</span>cv2<span class="token punctuation">.</span>CV_64F<span class="token punctuation">)</span><span class="token operator">*</span>maxV</span>
<span class="line">E <span class="token operator">=</span> E<span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span></span>
<span class="line">A <span class="token operator">=</span> cv2<span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>backImg<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>NORM_MINMAX<span class="token punctuation">,</span> dtype<span class="token operator">=</span>cv2<span class="token punctuation">.</span>CV_64F<span class="token punctuation">)</span><span class="token operator">*</span>maxV</span>
<span class="line">A <span class="token operator">=</span> A<span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">132</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>E<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">&#39;gray&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&quot;Target&quot;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">133</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>A<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">&#39;gray&#39;</span><span class="token punctuation">)</span></span>
<span class="line">plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&quot;Background&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="自己的疑问" tabindex="-1"><a class="header-anchor" href="#自己的疑问"><span>自己的疑问</span></a></h4><p>为什么平均对待奇异值会导致无法区分出背景与目标</p><p>为什么会这么计算先验权重图</p></div></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Last Updated 4/12/2025, 1:07:53 AM<!--]--></span></span></div></footer><!----><!----></div><div class="page-catalog-container"><h5 class="tip">ON THIS PAGE</h5><ul><!--[--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/Others/ReWIPI_NRAM.html#基于最小化联合l2-1范数的非凸秩估计的红外小目标检测" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="基于最小化联合l2,1范数的非凸秩估计的红外小目标检测"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->基于最小化联合l2,1范数的非凸秩估计的红外小目标检测<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/Others/ReWIPI_NRAM.html#ipi模型" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="IPI模型"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->IPI模型<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/Others/ReWIPI_NRAM.html#rewipi模型" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="ReWIPI模型"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->ReWIPI模型<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/Others/ReWIPI_NRAM.html#robust-pca-via-nonconvex-rank-approximation" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Robust PCA via Nonconvex Rank Approximation"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Robust PCA via Nonconvex Rank Approximation<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/Others/ReWIPI_NRAM.html#infrared-small-target-detection-via-non-convex-rank-approximation-minimization-joint-l2-1-norm" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Infrared Small Target Detection via Non-Convex Rank Approximation Minimization Joint l2,1 Norm"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Infrared Small Target Detection via Non-Convex Rank Approximation Minimization Joint l2,1 Norm<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--]--></ul></div></main><!--]--></div></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BSRiWrsC.js" defer></script>
  </body>
</html>
